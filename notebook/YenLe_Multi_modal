{
  "cells": [
    {
      "cell_type": "markdown",
      "source": [
        "### Importing Data"
      ],
      "metadata": {
        "id": "9kICvFvOQ0aA"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "4H5mH8uATaWl"
      },
      "outputs": [],
      "source": [
        "#Importing required libraries\n",
        "import matplotlib.pyplot as plt\n",
        "from PIL import Image\n",
        "import seaborn as sns\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "import os\n",
        "from tensorflow.keras.utils import to_categorical\n",
        "from glob import glob"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive/')\n",
        "\n",
        "path = '/content/drive/MyDrive/HAMdatset/HAM10000_images_part_1.zip/'"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nJFpR2EWaVho",
        "outputId": "56980dbf-8eae-48f0-96a0-1ad9745a0a4d"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive/\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import zipfile\n",
        "import os\n",
        "\n",
        "# Path to the ZIP file\n",
        "zip_path = '/content/drive/MyDrive/HAMdatset/HAM10000_images_part_1.zip'\n",
        "\n",
        "# Directory where you want to extract the images\n",
        "extraction_directory = '/content'\n",
        "\n",
        "# Specific folder inside the ZIP from which you want to extract images\n",
        "target_folder = 'HAM10000_images_part_1/'\n",
        "\n",
        "# Create the directory if it does not exist\n",
        "if not os.path.exists(extraction_directory):\n",
        "    os.makedirs(extraction_directory)\n",
        "\n",
        "# Open the ZIP file\n",
        "with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n",
        "    # Iterate over each file in the ZIP file\n",
        "    for file in zip_ref.namelist():\n",
        "        # Check if the file is in the target folder and is an image\n",
        "        if file.startswith(target_folder) and file.endswith(('.jpg', '.png')):\n",
        "            # Extract the image file\n",
        "            zip_ref.extract(file, extraction_directory)\n",
        "\n",
        "# Optionally, list the files in the extraction directory to confirm\n",
        "extracted_files = os.listdir(extraction_directory)\n",
        "\n"
      ],
      "metadata": {
        "id": "NgI1S4ZMepi5"
      },
      "execution_count": 3,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive/')\n",
        "\n",
        "path = '/content/drive/MyDrive/HAMdatset/HAM10000_images_part_2.zip/'"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Rblvro-Qf4YN",
        "outputId": "ed09c3ee-4221-4113-a77f-881813bc23c3"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Drive already mounted at /content/drive/; to attempt to forcibly remount, call drive.mount(\"/content/drive/\", force_remount=True).\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import zipfile\n",
        "import os\n",
        "\n",
        "# Path to the ZIP file\n",
        "zip_path = '/content/drive/MyDrive/HAMdatset/HAM10000_images_part_2.zip'\n",
        "\n",
        "# Directory where you want to extract the images\n",
        "extraction_directory = '/content'\n",
        "\n",
        "# Specific folder inside the ZIP from which you want to extract images\n",
        "target_folder = 'HAM10000_images_part_2/'\n",
        "\n",
        "# Create the directory if it does not exist\n",
        "if not os.path.exists(extraction_directory):\n",
        "    os.makedirs(extraction_directory)\n",
        "\n",
        "# Open the ZIP file\n",
        "with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n",
        "    # Iterate over each file in the ZIP file\n",
        "    for file in zip_ref.namelist():\n",
        "        # Check if the file is in the target folder and is an image\n",
        "        if file.startswith(target_folder) and file.endswith(('.jpg', '.png')):\n",
        "            # Extract the image file\n",
        "            zip_ref.extract(file, extraction_directory)\n",
        "\n",
        "# Optionally, list the files in the extraction directory to confirm\n",
        "extracted_files = os.listdir(extraction_directory)\n"
      ],
      "metadata": {
        "id": "mJ__DuzAf4bE"
      },
      "execution_count": 5,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "JfNaZdfOepnC"
      },
      "execution_count": 5,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Pre-process HAM dataset"
      ],
      "metadata": {
        "id": "SSILSTIK3ntp"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "meta = pd.read_csv('HAM10000_metadata.csv')\n",
        "\n",
        "meta"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "lv0s1Chofcs7",
        "outputId": "4b855e7b-54d8-4e96-d7df-2120dadb1d06"
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "         lesion_id      image_id     dx dx_type   age     sex localization\n",
              "0      HAM_0000118  ISIC_0027419    bkl   histo  80.0    male        scalp\n",
              "1      HAM_0000118  ISIC_0025030    bkl   histo  80.0    male        scalp\n",
              "2      HAM_0002730  ISIC_0026769    bkl   histo  80.0    male        scalp\n",
              "3      HAM_0002730  ISIC_0025661    bkl   histo  80.0    male        scalp\n",
              "4      HAM_0001466  ISIC_0031633    bkl   histo  75.0    male          ear\n",
              "...            ...           ...    ...     ...   ...     ...          ...\n",
              "10010  HAM_0002867  ISIC_0033084  akiec   histo  40.0    male      abdomen\n",
              "10011  HAM_0002867  ISIC_0033550  akiec   histo  40.0    male      abdomen\n",
              "10012  HAM_0002867  ISIC_0033536  akiec   histo  40.0    male      abdomen\n",
              "10013  HAM_0000239  ISIC_0032854  akiec   histo  80.0    male         face\n",
              "10014  HAM_0003521  ISIC_0032258    mel   histo  70.0  female         back\n",
              "\n",
              "[10015 rows x 7 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-f8d045ad-6099-46a3-b1f1-48ac2e77ca55\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>image_id</th>\n",
              "      <th>dx</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>age</th>\n",
              "      <th>sex</th>\n",
              "      <th>localization</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0027419</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0025030</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0026769</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0025661</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>HAM_0001466</td>\n",
              "      <td>ISIC_0031633</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>75.0</td>\n",
              "      <td>male</td>\n",
              "      <td>ear</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10010</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033084</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10011</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033550</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10012</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033536</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10013</th>\n",
              "      <td>HAM_0000239</td>\n",
              "      <td>ISIC_0032854</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>face</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10014</th>\n",
              "      <td>HAM_0003521</td>\n",
              "      <td>ISIC_0032258</td>\n",
              "      <td>mel</td>\n",
              "      <td>histo</td>\n",
              "      <td>70.0</td>\n",
              "      <td>female</td>\n",
              "      <td>back</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>10015 rows × 7 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f8d045ad-6099-46a3-b1f1-48ac2e77ca55')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-f8d045ad-6099-46a3-b1f1-48ac2e77ca55 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-f8d045ad-6099-46a3-b1f1-48ac2e77ca55');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-65b21ad1-bd9c-4095-b6da-60ebcca9a21c\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-65b21ad1-bd9c-4095-b6da-60ebcca9a21c')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-65b21ad1-bd9c-4095-b6da-60ebcca9a21c button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_389d2c11-ec19-41c7-bcf6-56e419e7ae1a\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('meta')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_389d2c11-ec19-41c7-bcf6-56e419e7ae1a button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('meta');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Base dictionary\n",
        "import glob\n",
        "base_skin_dir = '/content/'\n",
        "\n",
        "# Assuming you have two folders named 'HAM10000_images_part_1' and 'HAM10000_images_part_2'\n",
        "folders = ['HAM10000_images_part_1', 'HAM10000_images_part_2']\n",
        "\n",
        "# Merge images from both folders into one dictionary and find the images based on the image_id\n",
        "imageid_path_dict = {\n",
        "    os.path.splitext(os.path.basename(x))[0]: x\n",
        "    for folder in folders\n",
        "    for x in glob.glob(os.path.join(base_skin_dir, folder, '*.jpg'))\n",
        "}"
      ],
      "metadata": {
        "id": "rvX62CfLfcvg"
      },
      "execution_count": 7,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "meta['path'] = meta['image_id'].map(imageid_path_dict.get)\n",
        "\n",
        "meta"
      ],
      "metadata": {
        "id": "jnfnWYMXfcyI",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "outputId": "dfce0cd6-c151-44c3-d540-232f3f4ff4d2"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "         lesion_id      image_id     dx dx_type   age     sex localization  \\\n",
              "0      HAM_0000118  ISIC_0027419    bkl   histo  80.0    male        scalp   \n",
              "1      HAM_0000118  ISIC_0025030    bkl   histo  80.0    male        scalp   \n",
              "2      HAM_0002730  ISIC_0026769    bkl   histo  80.0    male        scalp   \n",
              "3      HAM_0002730  ISIC_0025661    bkl   histo  80.0    male        scalp   \n",
              "4      HAM_0001466  ISIC_0031633    bkl   histo  75.0    male          ear   \n",
              "...            ...           ...    ...     ...   ...     ...          ...   \n",
              "10010  HAM_0002867  ISIC_0033084  akiec   histo  40.0    male      abdomen   \n",
              "10011  HAM_0002867  ISIC_0033550  akiec   histo  40.0    male      abdomen   \n",
              "10012  HAM_0002867  ISIC_0033536  akiec   histo  40.0    male      abdomen   \n",
              "10013  HAM_0000239  ISIC_0032854  akiec   histo  80.0    male         face   \n",
              "10014  HAM_0003521  ISIC_0032258    mel   histo  70.0  female         back   \n",
              "\n",
              "                                                   path  \n",
              "0      /content/HAM10000_images_part_1/ISIC_0027419.jpg  \n",
              "1      /content/HAM10000_images_part_1/ISIC_0025030.jpg  \n",
              "2      /content/HAM10000_images_part_1/ISIC_0026769.jpg  \n",
              "3      /content/HAM10000_images_part_1/ISIC_0025661.jpg  \n",
              "4      /content/HAM10000_images_part_2/ISIC_0031633.jpg  \n",
              "...                                                 ...  \n",
              "10010  /content/HAM10000_images_part_2/ISIC_0033084.jpg  \n",
              "10011  /content/HAM10000_images_part_2/ISIC_0033550.jpg  \n",
              "10012  /content/HAM10000_images_part_2/ISIC_0033536.jpg  \n",
              "10013  /content/HAM10000_images_part_2/ISIC_0032854.jpg  \n",
              "10014  /content/HAM10000_images_part_2/ISIC_0032258.jpg  \n",
              "\n",
              "[10015 rows x 8 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-5d781f62-ff6a-4995-a141-e3057550560d\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>image_id</th>\n",
              "      <th>dx</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>age</th>\n",
              "      <th>sex</th>\n",
              "      <th>localization</th>\n",
              "      <th>path</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0027419</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0027419.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0025030</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025030.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0026769</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0026769.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0025661</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025661.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>HAM_0001466</td>\n",
              "      <td>ISIC_0031633</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>75.0</td>\n",
              "      <td>male</td>\n",
              "      <td>ear</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0031633.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10010</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033084</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033084.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10011</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033550</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033550.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10012</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033536</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033536.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10013</th>\n",
              "      <td>HAM_0000239</td>\n",
              "      <td>ISIC_0032854</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>face</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032854.jpg</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10014</th>\n",
              "      <td>HAM_0003521</td>\n",
              "      <td>ISIC_0032258</td>\n",
              "      <td>mel</td>\n",
              "      <td>histo</td>\n",
              "      <td>70.0</td>\n",
              "      <td>female</td>\n",
              "      <td>back</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032258.jpg</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>10015 rows × 8 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5d781f62-ff6a-4995-a141-e3057550560d')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-5d781f62-ff6a-4995-a141-e3057550560d button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-5d781f62-ff6a-4995-a141-e3057550560d');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-91a674cd-967e-4aa5-8db9-6ba35d129d52\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-91a674cd-967e-4aa5-8db9-6ba35d129d52')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-91a674cd-967e-4aa5-8db9-6ba35d129d52 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_901db3b8-7e03-4fef-b3d2-6bf4b993f572\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('meta')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_901db3b8-7e03-4fef-b3d2-6bf4b993f572 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('meta');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Lesion Dictionary categorical codes\n",
        "lesion_code_dict = {\n",
        "    'nv': 0,\n",
        "    'mel': 1,\n",
        "    'bkl': 2,\n",
        "    'bcc': 3,\n",
        "    'akiec': 4,\n",
        "    'vasc': 5,\n",
        "    'df': 6}\n",
        "\n",
        "meta['dx_code'] = meta['dx'].map(lesion_code_dict.get)\n",
        "\n",
        "meta"
      ],
      "metadata": {
        "id": "qjmRmybrfyFy",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "outputId": "ee229dff-3e86-4f62-d616-da2848ba0054"
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "         lesion_id      image_id     dx dx_type   age     sex localization  \\\n",
              "0      HAM_0000118  ISIC_0027419    bkl   histo  80.0    male        scalp   \n",
              "1      HAM_0000118  ISIC_0025030    bkl   histo  80.0    male        scalp   \n",
              "2      HAM_0002730  ISIC_0026769    bkl   histo  80.0    male        scalp   \n",
              "3      HAM_0002730  ISIC_0025661    bkl   histo  80.0    male        scalp   \n",
              "4      HAM_0001466  ISIC_0031633    bkl   histo  75.0    male          ear   \n",
              "...            ...           ...    ...     ...   ...     ...          ...   \n",
              "10010  HAM_0002867  ISIC_0033084  akiec   histo  40.0    male      abdomen   \n",
              "10011  HAM_0002867  ISIC_0033550  akiec   histo  40.0    male      abdomen   \n",
              "10012  HAM_0002867  ISIC_0033536  akiec   histo  40.0    male      abdomen   \n",
              "10013  HAM_0000239  ISIC_0032854  akiec   histo  80.0    male         face   \n",
              "10014  HAM_0003521  ISIC_0032258    mel   histo  70.0  female         back   \n",
              "\n",
              "                                                   path  dx_code  \n",
              "0      /content/HAM10000_images_part_1/ISIC_0027419.jpg        2  \n",
              "1      /content/HAM10000_images_part_1/ISIC_0025030.jpg        2  \n",
              "2      /content/HAM10000_images_part_1/ISIC_0026769.jpg        2  \n",
              "3      /content/HAM10000_images_part_1/ISIC_0025661.jpg        2  \n",
              "4      /content/HAM10000_images_part_2/ISIC_0031633.jpg        2  \n",
              "...                                                 ...      ...  \n",
              "10010  /content/HAM10000_images_part_2/ISIC_0033084.jpg        4  \n",
              "10011  /content/HAM10000_images_part_2/ISIC_0033550.jpg        4  \n",
              "10012  /content/HAM10000_images_part_2/ISIC_0033536.jpg        4  \n",
              "10013  /content/HAM10000_images_part_2/ISIC_0032854.jpg        4  \n",
              "10014  /content/HAM10000_images_part_2/ISIC_0032258.jpg        1  \n",
              "\n",
              "[10015 rows x 9 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-5df38a35-8437-4752-845d-eed2dec88ee2\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>image_id</th>\n",
              "      <th>dx</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>age</th>\n",
              "      <th>sex</th>\n",
              "      <th>localization</th>\n",
              "      <th>path</th>\n",
              "      <th>dx_code</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0027419</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0027419.jpg</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0025030</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025030.jpg</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0026769</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0026769.jpg</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0025661</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025661.jpg</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>HAM_0001466</td>\n",
              "      <td>ISIC_0031633</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>75.0</td>\n",
              "      <td>male</td>\n",
              "      <td>ear</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0031633.jpg</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10010</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033084</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033084.jpg</td>\n",
              "      <td>4</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10011</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033550</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033550.jpg</td>\n",
              "      <td>4</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10012</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033536</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033536.jpg</td>\n",
              "      <td>4</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10013</th>\n",
              "      <td>HAM_0000239</td>\n",
              "      <td>ISIC_0032854</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>face</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032854.jpg</td>\n",
              "      <td>4</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10014</th>\n",
              "      <td>HAM_0003521</td>\n",
              "      <td>ISIC_0032258</td>\n",
              "      <td>mel</td>\n",
              "      <td>histo</td>\n",
              "      <td>70.0</td>\n",
              "      <td>female</td>\n",
              "      <td>back</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032258.jpg</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>10015 rows × 9 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5df38a35-8437-4752-845d-eed2dec88ee2')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-5df38a35-8437-4752-845d-eed2dec88ee2 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-5df38a35-8437-4752-845d-eed2dec88ee2');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-fe849d6e-73dc-4a90-bf9a-b585b8c4c7a3\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-fe849d6e-73dc-4a90-bf9a-b585b8c4c7a3')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-fe849d6e-73dc-4a90-bf9a-b585b8c4c7a3 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_73856692-38d4-440c-a339-6a2a87a503ed\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('meta')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_73856692-38d4-440c-a339-6a2a87a503ed button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('meta');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "# Replace null with mean\n",
        "meta['age'].fillna((meta['age'].mean()), inplace=True)"
      ],
      "metadata": {
        "id": "RuwmvYvVfyIj"
      },
      "execution_count": 10,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tqdm import tqdm\n",
        "import numpy as np\n",
        "from PIL import Image\n",
        "\n",
        "image_paths = list(meta['path'])\n",
        "meta['image'] = [np.asarray(Image.open(path).resize((100, 75)), dtype=np.float32) / 255.0 for path in tqdm(image_paths)]\n",
        "\n",
        "meta\n"
      ],
      "metadata": {
        "id": "rnQUbbtDfyTP",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 441
        },
        "outputId": "71792ff0-09c2-4aba-83fa-b2126a83ec6d"
      },
      "execution_count": 11,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 10015/10015 [01:48<00:00, 92.55it/s] \n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "         lesion_id      image_id     dx dx_type   age     sex localization  \\\n",
              "0      HAM_0000118  ISIC_0027419    bkl   histo  80.0    male        scalp   \n",
              "1      HAM_0000118  ISIC_0025030    bkl   histo  80.0    male        scalp   \n",
              "2      HAM_0002730  ISIC_0026769    bkl   histo  80.0    male        scalp   \n",
              "3      HAM_0002730  ISIC_0025661    bkl   histo  80.0    male        scalp   \n",
              "4      HAM_0001466  ISIC_0031633    bkl   histo  75.0    male          ear   \n",
              "...            ...           ...    ...     ...   ...     ...          ...   \n",
              "10010  HAM_0002867  ISIC_0033084  akiec   histo  40.0    male      abdomen   \n",
              "10011  HAM_0002867  ISIC_0033550  akiec   histo  40.0    male      abdomen   \n",
              "10012  HAM_0002867  ISIC_0033536  akiec   histo  40.0    male      abdomen   \n",
              "10013  HAM_0000239  ISIC_0032854  akiec   histo  80.0    male         face   \n",
              "10014  HAM_0003521  ISIC_0032258    mel   histo  70.0  female         back   \n",
              "\n",
              "                                                   path  dx_code  \\\n",
              "0      /content/HAM10000_images_part_1/ISIC_0027419.jpg        2   \n",
              "1      /content/HAM10000_images_part_1/ISIC_0025030.jpg        2   \n",
              "2      /content/HAM10000_images_part_1/ISIC_0026769.jpg        2   \n",
              "3      /content/HAM10000_images_part_1/ISIC_0025661.jpg        2   \n",
              "4      /content/HAM10000_images_part_2/ISIC_0031633.jpg        2   \n",
              "...                                                 ...      ...   \n",
              "10010  /content/HAM10000_images_part_2/ISIC_0033084.jpg        4   \n",
              "10011  /content/HAM10000_images_part_2/ISIC_0033550.jpg        4   \n",
              "10012  /content/HAM10000_images_part_2/ISIC_0033536.jpg        4   \n",
              "10013  /content/HAM10000_images_part_2/ISIC_0032854.jpg        4   \n",
              "10014  /content/HAM10000_images_part_2/ISIC_0032258.jpg        1   \n",
              "\n",
              "                                                   image  \n",
              "0      [[[0.74509805, 0.6, 0.7607843], [0.7529412, 0....  \n",
              "1      [[[0.09019608, 0.050980393, 0.08627451], [0.09...  \n",
              "2      [[[0.7254902, 0.49803922, 0.5372549], [0.74117...  \n",
              "3      [[[0.09411765, 0.043137256, 0.06666667], [0.10...  \n",
              "4      [[[0.5254902, 0.3529412, 0.44313726], [0.57647...  \n",
              "...                                                  ...  \n",
              "10010  [[[0.60784316, 0.5372549, 0.5803922], [0.60392...  \n",
              "10011  [[[0.019607844, 0.023529412, 0.015686275], [0....  \n",
              "10012  [[[0.4392157, 0.4, 0.4117647], [0.49803922, 0....  \n",
              "10013  [[[0.61960787, 0.47843137, 0.57254905], [0.623...  \n",
              "10014  [[[0.69803923, 0.57254905, 0.5176471], [0.6901...  \n",
              "\n",
              "[10015 rows x 10 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-745dbccf-0dfc-4315-b326-ed0bc8c4f867\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>image_id</th>\n",
              "      <th>dx</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>age</th>\n",
              "      <th>sex</th>\n",
              "      <th>localization</th>\n",
              "      <th>path</th>\n",
              "      <th>dx_code</th>\n",
              "      <th>image</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0027419</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0027419.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.74509805, 0.6, 0.7607843], [0.7529412, 0....</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0025030</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025030.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.09019608, 0.050980393, 0.08627451], [0.09...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0026769</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0026769.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.7254902, 0.49803922, 0.5372549], [0.74117...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0025661</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025661.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.09411765, 0.043137256, 0.06666667], [0.10...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>HAM_0001466</td>\n",
              "      <td>ISIC_0031633</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>75.0</td>\n",
              "      <td>male</td>\n",
              "      <td>ear</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0031633.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.5254902, 0.3529412, 0.44313726], [0.57647...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10010</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033084</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033084.jpg</td>\n",
              "      <td>4</td>\n",
              "      <td>[[[0.60784316, 0.5372549, 0.5803922], [0.60392...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10011</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033550</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033550.jpg</td>\n",
              "      <td>4</td>\n",
              "      <td>[[[0.019607844, 0.023529412, 0.015686275], [0....</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10012</th>\n",
              "      <td>HAM_0002867</td>\n",
              "      <td>ISIC_0033536</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>40.0</td>\n",
              "      <td>male</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0033536.jpg</td>\n",
              "      <td>4</td>\n",
              "      <td>[[[0.4392157, 0.4, 0.4117647], [0.49803922, 0....</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10013</th>\n",
              "      <td>HAM_0000239</td>\n",
              "      <td>ISIC_0032854</td>\n",
              "      <td>akiec</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>face</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032854.jpg</td>\n",
              "      <td>4</td>\n",
              "      <td>[[[0.61960787, 0.47843137, 0.57254905], [0.623...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10014</th>\n",
              "      <td>HAM_0003521</td>\n",
              "      <td>ISIC_0032258</td>\n",
              "      <td>mel</td>\n",
              "      <td>histo</td>\n",
              "      <td>70.0</td>\n",
              "      <td>female</td>\n",
              "      <td>back</td>\n",
              "      <td>/content/HAM10000_images_part_2/ISIC_0032258.jpg</td>\n",
              "      <td>1</td>\n",
              "      <td>[[[0.69803923, 0.57254905, 0.5176471], [0.6901...</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>10015 rows × 10 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-745dbccf-0dfc-4315-b326-ed0bc8c4f867')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-745dbccf-0dfc-4315-b326-ed0bc8c4f867 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-745dbccf-0dfc-4315-b326-ed0bc8c4f867');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-23101eca-2822-4b3e-b61f-338d97848cf2\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-23101eca-2822-4b3e-b61f-338d97848cf2')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-23101eca-2822-4b3e-b61f-338d97848cf2 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_a968c039-81bc-4f54-83ae-19c8ce23e02c\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('meta')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_a968c039-81bc-4f54-83ae-19c8ce23e02c button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('meta');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Ignore this section --> delete code no need ,"
      ],
      "metadata": {
        "id": "_3YXfFfx3ttB"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "from keras.utils import to_categorical\n",
        "\n",
        "X = meta['image']\n",
        "y = to_categorical(meta['dx_code'])\n"
      ],
      "metadata": {
        "id": "ZpD0OW8DfyVp"
      },
      "execution_count": 12,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "# Split the data into training and testing sets\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=42)"
      ],
      "metadata": {
        "id": "WuXVxHomfyYO"
      },
      "execution_count": 13,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "print(X_train.shape , \"\\n\")\n",
        "print(X_train[1].shape , \"\\n\")"
      ],
      "metadata": {
        "id": "MYzABAX-fybD",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "8e7d954c-4dd9-4375-9597-b839342c21b5"
      },
      "execution_count": 14,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(8012,) \n",
            "\n",
            "(75, 100, 3) \n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "type(X_train)\n"
      ],
      "metadata": {
        "id": "nidAFz5Qfc5c",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "88413179-c514-4ea6-ec2a-01b912e33630"
      },
      "execution_count": 15,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "pandas.core.series.Series"
            ]
          },
          "metadata": {},
          "execution_count": 15
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train = np.array(X_train.tolist())\n",
        "X_test = np.array(X_test.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 75, width = 100, channel = 3)\n",
        "X_train = X_train.reshape(X_train.shape[0], 75, 100, 3)\n",
        "X_test = X_test.reshape(X_test.shape[0], 75, 100, 3)"
      ],
      "metadata": {
        "id": "26R8CFfzfc8B"
      },
      "execution_count": 16,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Defining method"
      ],
      "metadata": {
        "id": "vTBNDGBe3xx6"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
        "\n",
        "# With data augmentation to prevent overfitting\n",
        "\n",
        "datagen = ImageDataGenerator(\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.1,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.1,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=False,  # randomly flip images\n",
        "        vertical_flip=False)  # randomly flip images\n",
        "\n",
        "datagen.fit(X_train)\n"
      ],
      "metadata": {
        "id": "tDClBtCkgtSx"
      },
      "execution_count": 17,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Function to plot the confusion matrix with Plotly\n",
        "def plot_confusion_matrix(cm, classes, normalize=False):\n",
        "    if normalize:\n",
        "        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n",
        "        colorscale = 'Plasma'\n",
        "    else:\n",
        "        colorscale = 'Magma_r'  # Reversed 'Magma' colorscale for non-normalized matrix\n",
        "\n",
        "    annotations = []\n",
        "    for i in range(len(classes)):\n",
        "        for j in range(len(classes)):\n",
        "            annotations.append(\n",
        "                {\n",
        "                    'x': classes[j],\n",
        "                    'y': classes[i],\n",
        "                    'text': str(cm[i, j]),\n",
        "                    'showarrow': False,\n",
        "                    'font': {'color': 'red' if cm[i, j] > 0.5 else 'black'}\n",
        "                }\n",
        "            )\n",
        "\n",
        "    fig = go.Figure(data=go.Heatmap(\n",
        "        z=cm,\n",
        "        x=list(classes),\n",
        "        y=list(classes),\n",
        "        colorscale=colorscale,\n",
        "        colorbar=dict(title='Normalized' if normalize else 'Count'),\n",
        "        showscale=True,\n",
        "        hoverinfo='z'\n",
        "    ))\n",
        "\n",
        "    fig.update_layout(\n",
        "        title='Confusion Matrix',\n",
        "        xaxis=dict(title='Predicted label'),\n",
        "        yaxis=dict(title='True label'),\n",
        "        annotations=annotations\n",
        "    )\n",
        "\n",
        "    if normalize:\n",
        "        fig.update_layout(title_text='Normalized Confusion Matrix')\n",
        "    else:\n",
        "        fig.update_layout(title_text='Confusion Matrix (Counts)')\n",
        "\n",
        "    fig.show()\n"
      ],
      "metadata": {
        "id": "10V0x8-mgtVJ"
      },
      "execution_count": 18,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)"
      ],
      "metadata": {
        "id": "7gz4NHZGgtXe"
      },
      "execution_count": 19,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Training basline Model -- milestone 2"
      ],
      "metadata": {
        "id": "-O5yM9qk3z40"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import DenseNet121\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "\n",
        "# Load the pre-trained DenseNet-121 model (weights pre-trained on ImageNet)\n",
        "base_model = DenseNet201(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95  # Choose the number of layers you want to freeze\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Add custom classification layers on top of the base model\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\n",
        "x = BatchNormalization()(x)  # Add BatchNormalization layer for better convergence\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model\n",
        "model_dense = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n",
        "'''"
      ],
      "metadata": {
        "id": "vSpka5yvgtZh",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 87
        },
        "outputId": "64f100d0-a401-428a-89ff-319e2d611d41"
      },
      "execution_count": 20,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "'\\nimport tensorflow as tf\\nfrom tensorflow.keras.applications import DenseNet121\\nfrom tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization\\nfrom tensorflow.keras.models import Model\\nfrom tensorflow.keras.optimizers import Adam\\n\\n# Load the pre-trained DenseNet-121 model (weights pre-trained on ImageNet)\\nbase_model = DenseNet201(weights=\\'imagenet\\', include_top=False)\\n\\n# Freeze some layers in the base model\\nnum_layers_to_freeze = 95  # Choose the number of layers you want to freeze\\nfor layer in base_model.layers[:num_layers_to_freeze]:\\n    layer.trainable = False\\n\\n# Add custom classification layers on top of the base model\\nx = base_model.output\\nx = GlobalAveragePooling2D()(x)\\nx = Dense(256, activation=\\'relu\\', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\\nx = BatchNormalization()(x)  # Add BatchNormalization layer for better convergence\\npredictions = Dense(7, activation=\\'softmax\\')(x)\\n\\n# Create the final model\\nmodel_dense = Model(inputs=base_model.input, outputs=predictions)\\n\\n# Learning Rate Scheduler\\ninitial_learning_rate = 0.0005\\nlr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\\n    initial_learning_rate,\\n    decay_steps=10000,   # Adjust decay_steps\\n    decay_rate=0.9       # Adjust decay_rate\\n)\\noptimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\\n\\nmodel_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\\n\\n# Early Stopping\\nearly_stopping = EarlyStopping(monitor=\\'val_loss\\', patience=15, restore_best_weights=True)\\n'"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "string"
            }
          },
          "metadata": {},
          "execution_count": 20
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "# Fit the model\n",
        "epochs = 60\n",
        "batch_size = 60\n",
        "history = model_dense.fit_generator(datagen.flow(X_train, y_train, batch_size=batch_size),\n",
        "                                    epochs=epochs, verbose=1, steps_per_epoch=X_train.shape[0] // batch_size,\n",
        "                                    callbacks=[learning_rate_reduction,early_stopping], validation_data=(X_test, y_test))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "'''\n"
      ],
      "metadata": {
        "id": "Q1esQA3zgtcH",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 70
        },
        "outputId": "440017df-f8ac-4c5b-f20d-134759cc1ed8"
      },
      "execution_count": 21,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "\"\\n# Fit the model\\nepochs = 60\\nbatch_size = 60\\nhistory = model_dense.fit_generator(datagen.flow(X_train, y_train, batch_size=batch_size),\\n                                    epochs=epochs, verbose=1, steps_per_epoch=X_train.shape[0] // batch_size,\\n                                    callbacks=[learning_rate_reduction,early_stopping], validation_data=(X_test, y_test))\\n\\n# Plot the training and validation loss\\nplt.figure(figsize=(10, 5))\\nplt.plot(history.history['loss'], label='Training Loss')\\nplt.plot(history.history['val_loss'], label='Validation Loss')\\nplt.xlabel('Epochs')\\nplt.ylabel('Loss')\\nplt.legend()\\nplt.title('Training and Validation Loss')\\nplt.show()\\n\""
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "string"
            }
          },
          "metadata": {},
          "execution_count": 21
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### merge categorical and images data"
      ],
      "metadata": {
        "id": "LMjpa59u33N2"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "split_proportion = 0.8\n",
        "\n",
        "# Randomly shuffle the rows of the DataFrame\n",
        "shuffled_data = meta.sample(frac=1, random_state=41)  # random_state for reproducibility\n",
        "\n",
        "# Calculate the number of rows for the first piece\n",
        "total_rows = shuffled_data.shape[0]\n",
        "split_size = int(total_rows * split_proportion)\n",
        "\n",
        "# Split the DataFrame into two pieces\n",
        "Train = shuffled_data.iloc[:split_size]\n",
        "Test = shuffled_data.iloc[split_size:]"
      ],
      "metadata": {
        "id": "1mVEZ1D5gtew"
      },
      "execution_count": 22,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "from keras.utils import to_categorical\n",
        "\n",
        "X_train_image = Train['image']\n",
        "y_train = to_categorical(Train['dx_code'])\n",
        "\n",
        "X_test_image = Test['image']\n",
        "y_test = to_categorical(Test['dx_code'])"
      ],
      "metadata": {
        "id": "rYTR2bWNhOkE"
      },
      "execution_count": 23,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train_image = np.array(X_train_image.tolist())\n",
        "X_test_image = np.array(X_test_image.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 75, width = 100, channel = 3)\n",
        "X_train_image = X_train_image.reshape(X_train_image.shape[0], 75, 100, 3)\n",
        "X_test_image = X_test_image.reshape(X_test_image.shape[0], 75, 100, 3)\n"
      ],
      "metadata": {
        "id": "Twci-V_vgthD"
      },
      "execution_count": 24,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "categorical_data_train = Train[['age', 'dx_type', \"localization\"]].copy()\n",
        "categorical_data_test = Test[['age', 'dx_type', \"localization\"]].copy()\n"
      ],
      "metadata": {
        "id": "zjsJWoejfc-Y"
      },
      "execution_count": 25,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "# Define the columns you want to scale\n",
        "columns_to_scale = ['age']\n",
        "\n",
        "# Create a StandardScaler object\n",
        "scaler = StandardScaler()\n",
        "\n",
        "# Scale the 'age' column for training data\n",
        "categorical_data_train.loc[:, columns_to_scale] = scaler.fit_transform(categorical_data_train[columns_to_scale].values.reshape(-1, 1))\n",
        "\n",
        "# Scale the 'age' column for testing data\n",
        "categorical_data_test.loc[:, columns_to_scale] = scaler.transform(categorical_data_test[columns_to_scale].values.reshape(-1, 1))\n"
      ],
      "metadata": {
        "id": "tjG_z9DWkA81"
      },
      "execution_count": 26,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "# List of columns to one-hot encode\n",
        "columns_to_encode = ['dx_type', 'localization']\n",
        "\n",
        "# Perform one-hot encoding using get_dummies\n",
        "encoded_train = pd.get_dummies(categorical_data_train, columns=columns_to_encode)\n",
        "encoded_test = pd.get_dummies(categorical_data_test, columns=columns_to_encode)\n"
      ],
      "metadata": {
        "id": "J1q1LCOzfdBP"
      },
      "execution_count": 27,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Create model checkpoint"
      ],
      "metadata": {
        "id": "Jwy1Snov3-DF"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "### TODO: Checkpoint the model .\n",
        "from tensorflow.keras.callbacks import ModelCheckpoint\n",
        "\n",
        "model_filepath = \"/content/drive/MyDrive/HAMdatset/model-{epoch:02d}-{val_accuracy:.4f}.hdf5\"\n",
        "\n",
        "#Saves model when the validation accuracy is improving\n",
        "checkpoint = ModelCheckpoint(\n",
        "    filepath = model_filepath,\n",
        "    monitor='val_accuracy',\n",
        "    mode='max',\n",
        "    save_best_only=True,\n",
        "    verbose=1\n",
        ")\n",
        "'''"
      ],
      "metadata": {
        "id": "3FXPnmSaUou1",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 53
        },
        "outputId": "ee6c8a68-144f-401b-d96c-5681e1cc1a08"
      },
      "execution_count": 28,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "'\\n### TODO: Checkpoint the model .\\nfrom tensorflow.keras.callbacks import ModelCheckpoint\\n\\nmodel_filepath = \"/content/drive/MyDrive/HAMdatset/model-{epoch:02d}-{val_accuracy:.4f}.hdf5\"\\n\\n#Saves model when the validation accuracy is improving\\ncheckpoint = ModelCheckpoint(\\n    filepath = model_filepath,\\n    monitor=\\'val_accuracy\\',\\n    mode=\\'max\\',\\n    save_best_only=True,\\n    verbose=1\\n)\\n'"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "string"
            }
          },
          "metadata": {},
          "execution_count": 28
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "### DenseNet201  model - multi-modal"
      ],
      "metadata": {
        "id": "hEoYJqg74Aju"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import DenseNet201\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Input, Concatenate\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "\n",
        "categorical_input = Input(shape=(20,))\n",
        "\n",
        "# Load the pre-trained DenseNet-121 model (Same as before)\n",
        "base_model = DenseNet201(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# After GlobalAveragePooling2D layer, concatenate with the categorical input\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\n",
        "\n",
        "# Add Custom Layers for Categorical Data\n",
        "y = Dense(64, activation='relu')(categorical_input)\n",
        "x = Concatenate()([x, y])\n",
        "\n",
        "x = BatchNormalization()(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model with both image and categorical inputs\n",
        "model_dense = Model(inputs=[base_model.input, categorical_input], outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,\n",
        "    decay_rate=0.9\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)"
      ],
      "metadata": {
        "id": "A8EIagkgfdDu",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "2be5328a-23c4-4ec8-acf7-c81e38b52350"
      },
      "execution_count": 29,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/densenet/densenet201_weights_tf_dim_ordering_tf_kernels_notop.h5\n",
            "74836368/74836368 [==============================] - 1s 0us/step\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Train the model with data augmentation and callbacks\n",
        "\n",
        "### TODO: Put in check point in callback\n",
        "\n",
        "epochs = 60\n",
        "batch_size = 60\n",
        "history = model_dense.fit(\n",
        "    [X_train_image, encoded_train],  # Update with your actual image and categorical training data\n",
        "    y_train, epochs=epochs, batch_size=batch_size,\n",
        "    callbacks=[learning_rate_reduction , early_stopping], validation_data=([X_test_image, encoded_test], y_test)\n",
        ")\n",
        "\n",
        "# Plot the training and validation loss\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss for <<DenseNet201>> with Multi_modal')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy for <<DenseNet201>> with Multi_modal')\n",
        "plt.show()"
      ],
      "metadata": {
        "id": "WwvduYKQfdGN",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "outputId": "04effbf2-f118-44a0-c325-00a68b458467"
      },
      "execution_count": 31,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Epoch 1/60\n",
            "134/134 [==============================] - 157s 291ms/step - loss: 3.2038 - accuracy: 0.7228 - val_loss: 2.6201 - val_accuracy: 0.7049 - lr: 4.9930e-04\n",
            "Epoch 2/60\n",
            "134/134 [==============================] - 22s 167ms/step - loss: 1.5560 - accuracy: 0.8079 - val_loss: 66.5996 - val_accuracy: 0.5736 - lr: 4.9860e-04\n",
            "Epoch 3/60\n",
            "134/134 [==============================] - 24s 179ms/step - loss: 1.1102 - accuracy: 0.8068 - val_loss: 1.2291 - val_accuracy: 0.7703 - lr: 4.9789e-04\n",
            "Epoch 4/60\n",
            "134/134 [==============================] - 24s 177ms/step - loss: 0.7029 - accuracy: 0.8503 - val_loss: 0.7817 - val_accuracy: 0.7978 - lr: 4.9719e-04\n",
            "Epoch 5/60\n",
            "134/134 [==============================] - 23s 169ms/step - loss: 0.5313 - accuracy: 0.8751 - val_loss: 0.9561 - val_accuracy: 0.8043 - lr: 4.9649e-04\n",
            "Epoch 6/60\n",
            "134/134 [==============================] - 26s 197ms/step - loss: 0.3723 - accuracy: 0.9050 - val_loss: 0.8128 - val_accuracy: 0.7639 - lr: 4.9579e-04\n",
            "Epoch 7/60\n",
            "134/134 [==============================] - 23s 175ms/step - loss: 0.4947 - accuracy: 0.8570 - val_loss: 1.0201 - val_accuracy: 0.7688 - lr: 4.9509e-04\n",
            "Epoch 8/60\n",
            "134/134 [==============================] - 23s 174ms/step - loss: 0.3060 - accuracy: 0.9139 - val_loss: 0.6272 - val_accuracy: 0.8073 - lr: 4.9439e-04\n",
            "Epoch 9/60\n",
            "134/134 [==============================] - 27s 203ms/step - loss: 0.2124 - accuracy: 0.9422 - val_loss: 0.8420 - val_accuracy: 0.8228 - lr: 4.9369e-04\n",
            "Epoch 10/60\n",
            "134/134 [==============================] - 24s 179ms/step - loss: 0.1889 - accuracy: 0.9488 - val_loss: 0.7301 - val_accuracy: 0.8028 - lr: 4.9300e-04\n",
            "Epoch 11/60\n",
            "134/134 [==============================] - 24s 179ms/step - loss: 0.1446 - accuracy: 0.9636 - val_loss: 0.5960 - val_accuracy: 0.8432 - lr: 4.9230e-04\n",
            "Epoch 12/60\n",
            "134/134 [==============================] - 26s 192ms/step - loss: 0.0935 - accuracy: 0.9765 - val_loss: 0.7923 - val_accuracy: 0.8233 - lr: 4.9161e-04\n",
            "Epoch 13/60\n",
            "134/134 [==============================] - 25s 185ms/step - loss: 0.0756 - accuracy: 0.9822 - val_loss: 0.5856 - val_accuracy: 0.8542 - lr: 4.9091e-04\n",
            "Epoch 14/60\n",
            "134/134 [==============================] - 23s 173ms/step - loss: 0.0827 - accuracy: 0.9800 - val_loss: 0.8798 - val_accuracy: 0.8352 - lr: 4.9022e-04\n",
            "Epoch 15/60\n",
            "134/134 [==============================] - 24s 177ms/step - loss: 0.0773 - accuracy: 0.9813 - val_loss: 0.5722 - val_accuracy: 0.8507 - lr: 4.8953e-04\n",
            "Epoch 16/60\n",
            "134/134 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.9918\n",
            "Epoch 16: ReduceLROnPlateau reducing learning rate to 0.0002444185665808618.\n",
            "134/134 [==============================] - 24s 176ms/step - loss: 0.0451 - accuracy: 0.9918 - val_loss: 0.7058 - val_accuracy: 0.8367 - lr: 4.8884e-04\n",
            "Epoch 17/60\n",
            "134/134 [==============================] - 23s 171ms/step - loss: 0.0766 - accuracy: 0.9810 - val_loss: 1.1899 - val_accuracy: 0.7973 - lr: 4.8815e-04\n",
            "Epoch 18/60\n",
            "134/134 [==============================] - 26s 194ms/step - loss: 0.0709 - accuracy: 0.9832 - val_loss: 0.6380 - val_accuracy: 0.8507 - lr: 4.8746e-04\n",
            "Epoch 19/60\n",
            "134/134 [==============================] - ETA: 0s - loss: 0.0492 - accuracy: 0.9895\n",
            "Epoch 19: ReduceLROnPlateau reducing learning rate to 0.00024338552611880004.\n",
            "134/134 [==============================] - 24s 177ms/step - loss: 0.0492 - accuracy: 0.9895 - val_loss: 0.7253 - val_accuracy: 0.8352 - lr: 4.8677e-04\n",
            "Epoch 20/60\n",
            "134/134 [==============================] - 24s 181ms/step - loss: 0.0673 - accuracy: 0.9825 - val_loss: 291.0767 - val_accuracy: 0.3535 - lr: 4.8608e-04\n",
            "Epoch 21/60\n",
            "134/134 [==============================] - 24s 178ms/step - loss: 0.1533 - accuracy: 0.9589 - val_loss: 0.6996 - val_accuracy: 0.8392 - lr: 4.8540e-04\n",
            "Epoch 22/60\n",
            "134/134 [==============================] - ETA: 0s - loss: 0.0877 - accuracy: 0.9763\n",
            "Epoch 22: ReduceLROnPlateau reducing learning rate to 0.0002423568512313068.\n",
            "134/134 [==============================] - 23s 169ms/step - loss: 0.0877 - accuracy: 0.9763 - val_loss: 0.7111 - val_accuracy: 0.8337 - lr: 4.8471e-04\n",
            "Epoch 23/60\n",
            "134/134 [==============================] - 23s 175ms/step - loss: 0.0402 - accuracy: 0.9923 - val_loss: 0.7320 - val_accuracy: 0.8417 - lr: 4.8403e-04\n",
            "Epoch 24/60\n",
            "134/134 [==============================] - 26s 194ms/step - loss: 0.0529 - accuracy: 0.9869 - val_loss: 0.6765 - val_accuracy: 0.8342 - lr: 4.8335e-04\n",
            "Epoch 25/60\n",
            "134/134 [==============================] - ETA: 0s - loss: 0.0563 - accuracy: 0.9875\n",
            "Epoch 25: ReduceLROnPlateau reducing learning rate to 0.0002413325128145516.\n",
            "134/134 [==============================] - 24s 177ms/step - loss: 0.0563 - accuracy: 0.9875 - val_loss: 0.6004 - val_accuracy: 0.8512 - lr: 4.8267e-04\n",
            "Epoch 26/60\n",
            "134/134 [==============================] - 23s 174ms/step - loss: 0.0480 - accuracy: 0.9890 - val_loss: 0.8454 - val_accuracy: 0.8183 - lr: 4.8198e-04\n",
            "Epoch 27/60\n",
            "134/134 [==============================] - 24s 176ms/step - loss: 0.0391 - accuracy: 0.9915 - val_loss: 0.7949 - val_accuracy: 0.8352 - lr: 4.8130e-04\n",
            "Epoch 28/60\n",
            "134/134 [==============================] - ETA: 0s - loss: 0.0532 - accuracy: 0.9885\n",
            "Epoch 28: ReduceLROnPlateau reducing learning rate to 0.00024031251086853445.\n",
            "134/134 [==============================] - 23s 170ms/step - loss: 0.0532 - accuracy: 0.9885 - val_loss: 0.7023 - val_accuracy: 0.8507 - lr: 4.8063e-04\n",
            "Epoch 29/60\n",
            "134/134 [==============================] - 23s 174ms/step - loss: 0.0702 - accuracy: 0.9827 - val_loss: 0.7026 - val_accuracy: 0.8347 - lr: 4.7995e-04\n",
            "Epoch 30/60\n",
            "134/134 [==============================] - 27s 198ms/step - loss: 0.0436 - accuracy: 0.9920 - val_loss: 0.7499 - val_accuracy: 0.8382 - lr: 4.7927e-04\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 1000x500 with 1 Axes>"
            ],
            "image/png": "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MUgRERGR45GDj5tf9fbDIEVENsIgRURERI6HXfuIyMExSBEREZHjsVaQklu05K6CRERWwiBFREREjkUItkgRkcNjkCIiIiLHkpcFGAtM09YKUjnpgNFQvX0RERXBIEVERESORb54rlYHuLpXb1/ydaQAU5giIrISBikiIiJyLEW79UlS9faldQV03ub7JSKyAgYpIiIicizWOj9KppwnlWad/RERgUGKiIiIHI3Vg5Sv+X6JiKyAQYqIiIgci81apBikiMh6GKSIiIjIscjXfGKQIiIHxiBFREREjkUOPPLFdKuLQYqIbIBBioiIiByLrbr2yS1dRERWwCBFREREjkUJUn7W2Z/cssUWKSKyIgYpIiIicizyMOU8R4qIHBiDFBERETkWjtpHRE6AQYqIiIgci9Ii5Wed/TFIEZENMEgRERGRY7FZi1SadfZHRAQGKSIiInIkBblAfrZp2mpBys90f/smIIR19klEtR6DFBERETkOpdVIAvS+1tmnHMiM+UBetnX2SUS1HoMUEREROY6iQ59rrPRniqsHoNWZ75+IqJoYpIiIiMhxyBfNla/9ZA2SxAEniMjqGKSIiIjIcVh7oAkZgxQRWRmDFBERETkOWwUpuYVLbvEiIqomBikiIiJyHGyRIiInwSBFREREjoNBioicBIMUEREROQ55+HMGKSJycAxSRERE5DiKDn9uTQxSRGRlDFJERETkOGzWtc+vcP9p1t0vEdVaDFJERETkOHiOFBE5CQYpIiIichxskSIiJ8EgRURERI6DLVJE5CSqFKQuXLiAixcvKo/379+PSZMm4YMPPrBaYURERFTLGI1ATrppWr6ArrUwSBGRlVUpSD3yyCPYsWMHACAlJQX33Xcf9u/fj5deeglz5syxaoFERERUS+SmAxCmaVuN2pefDRTkWXffRFQrVSlI/fHHH+jcuTMA4Ouvv0abNm2wd+9eLF++HMuWLav0fnbv3o2BAwciNDQUkiRh7dq1ZstHjRoFSZLMbv369TNb58aNGxgxYgR8fHzg5+eHMWPGICsrqypPi4iIiNQktxa5egIueuvuW+8LQDJN56RZd99EVCtVKUjl5+dDrzd9wW3btg0PPPAAACAiIgKXL1+u9H6ys7PRvn17vPfee2Wu069fP1y+fFm5ffHFF2bLR4wYgWPHjmHr1q1Yv349du/ejbFjx1bhWREREZGqbHV+FABoNICbr/lxiIiqwaUqG7Vu3RpLlizBgAEDsHXrVrz66qsAgEuXLqFu3bqV3k9cXBzi4uLKXUev1yM4OLjUZSdOnMCmTZtw4MABdOzYEQCwcOFC9O/fH/Pnz0doaGilayEiIiKV2TJIyfvNSWOQIiKrqFKL1BtvvIH3338f0dHRGD58ONq3bw8A+O6775Quf9ayc+dOBAYGokWLFhg3bhyuX7+uLNu3bx/8/PyUEAUAMTEx0Gg0+OWXX8rcZ25uLjIyMsxuREREpDJ5aHJrnx8l44ATRGRFVWqRio6OxrVr15CRkYE6de7812js2LHw8PCwWnH9+vXDkCFD0LhxY5w5cwYvvvgi4uLisG/fPmi1WqSkpCAwMNBsGxcXF/j7+yMlJaXM/c6dOxezZ8+2Wp1ERERkBUqLlJ9t9q8EqTTb7J+IapUqBanbt29DCKGEqPPnz2PNmjVo2bIlYmNjrVbcsGHDlOm2bduiXbt2CA8Px86dO9GnT58q73f69OmYMmWK8jgjIwNhYWHVqpWIiIiqSWmRslXXPr/C47BFioiqr0pd+wYNGoRPP/0UAJCWloYuXbrgP//5D+Lj47F48WKrFlhUkyZNUK9ePZw+fRoAEBwcjCtXrpitU1BQgBs3bpR5XhVgOu/Kx8fH7EZEREQqs8c5UkWPQ0RUDVUKUocOHUL37t0BAKtWrUJQUBDOnz+PTz/9FO+8845VCyzq4sWLuH79OkJCQgAAUVFRSEtLw8GDB5V1fvjhBxiNRnTp0sVmdRAREZENMEgRkROpUte+W7duwdvbGwCwZcsWDBkyBBqNBvfccw/Onz9f6f1kZWUprUsAcPbsWRw+fBj+/v7w9/fH7NmzMXToUAQHB+PMmTN4/vnn0bRpU6X7YMuWLdGvXz888cQTWLJkCfLz8zFhwgQMGzaMI/YRERE5G/n6TgxSROQEqtQi1bRpU6xduxYXLlzA5s2b0bdvXwDAlStXLOom9+uvv+Luu+/G3XffDQCYMmUK7r77bsycORNarRZHjhzBAw88gObNm2PMmDGIjIzEjz/+qFzDCgCWL1+OiIgI9OnTB/3798e9996LDz74oCpPi4iIiNQkBxw3P9vsn0GKiKyoSi1SM2fOxCOPPILJkyejd+/eiIqKAmBqnZJDUWVER0dDCFHm8s2bN1e4D39/f6xYsaLSxyQiIiIHZeuufXJAk1u+iIiqoUpB6sEHH8S9996Ly5cvK9eQAoA+ffpg8ODBViuOiIiIahGeI0VETqRKQQowjZgXHByMixcvAgDq169v9YvxEhERUS0hBIMUETmVKp0jZTQaMWfOHPj6+qJhw4Zo2LAh/Pz88Oqrr8JoNFq7RiIiIqrp8m8BhjzTtM2DVBrAv1eIqJqq1CL10ksv4eOPP8b//d//oVu3bgCAn376CbNmzUJOTg7+/e9/W7VIIiIiquHki/FqXACdp22OIV+QFwLITbddYCOiWqFKQeqTTz7BRx99hAceeECZ165dO9x1110YP348gxQRERFZpmi3PkmyzTFc9ICrh6n163YagxQRVUuVuvbduHEDERERJeZHRETgxo0b1S6KiIiIahlbnx8l43lSRGQlVQpS7du3x7vvvlti/rvvvot27dpVuygiIiKqZRikiMjJVKlr37x58zBgwABs27ZNuYbUvn37cOHCBWzYsMGqBRIREVEtwCBFRE6mSi1SPXv2xJ9//onBgwcjLS0NaWlpGDJkCI4dO4bPPvvM2jUSERFRTSdfJNfmQcrPdM8gRUTVVOXrSIWGhpYYVOL333/Hxx9/jA8++KDahREREVEtIgcbNz/bHkcOanJwIyKqoiq1SBERERFZlb269slBTR5unYioihikiIiISH08R4qInAyDFBEREamPQYqInIxF50gNGTKk3OVpaWnVqYWIiIhqK7mrHYMUETkJi4KUr69vhctHjhxZrYKIiIioFlKClJ9tj6MEqTTbHoeIajyLgtTSpUttVQcRERHVZnbr2udnfjwioiriOVJERESkLkM+kJdpmrZn1z4hbHssIqrRGKSIiIhIXUW72bmVfxpBtclBypAL5N+27bGIqEZjkCIiIiJ1KRfj9QU0WtseS+cFaFzMj0tEVAUMUkRERKSunDTTvXyxXFuSJI7cR0RWwSBFRERE6rLXQBMyObDJAY6IqAoYpIiIiEhd9g5SbJEiIitgkCIiIiJ1MUgRkRNikCIiIiJ1MUgRkRNikCIiIiJ1ycOfM0gRkRNhkCIiIiJ1KS1SfvY5nnycotevIiKyEIMUERERqYtd+4jICTFIERERkboYpIjICTFIERERkboYpIjICTFIERERkbpUC1Jp9jkeEdVIDFJERESkHqMRyEkzTbv52eeYcpCSj0tEVAUM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YgX69++PunXr4siRI5g8eTJ69OiBdu3aqVw9Vdb06dMRFxeHBg0aIDMzEytWrMDOnTuxefNm23yOrTOwIFnDwoULRYMGDYROpxOdO3cWP//8s9olkRU9/PDDIiQkROh0OnHXXXeJhx9+WJw+fVrtsqiaduzYIQCUuCUkJAghTEOgz5gxQwQFBQm9Xi/69OkjkpKS1C2aLFLea3zr1i3Rt29fERAQIFxdXUXDhg3FE088IVJSUtQumyxQ2usLQCxdulRZ5/bt22L8+PGiTp06wsPDQwwePFhcvnxZvaLJIhW9xsnJyaJHjx7C399f6PV60bRpU/Hcc8+J9PR0dQsnizz22GOiYcOGQqfTiYCAANGnTx+xZcsWZbm1P8eSEEJUNfURERERERHVRjxHioiIiIiIyEIMUkRERERERBZikCIiIiIiIrIQgxQREREREZGFGKSIiIiIiIgsxCBFRERERERkIQYpIiIiIiIiCzFIERERERERWYhBioiIyEKSJGHt2rVql0FERCpikCIiIqcyatQoSJJU4tavXz+1SyMiolrERe0CiIiILNWvXz8sXbrUbJ5er1epGiIiqo3YIkVERE5Hr9cjODjY7FanTh0Apm53ixcvRlxcHNzd3dGkSROsWrXKbPujR4+id+/ecHd3R926dTF27FhkZWWZrfO///0PrVu3hl6vR0hICCZMmGC2/Nq1axg8eDA8PDzQrFkzfPfdd8qymzdvYsSIEQgICIC7uzuaNWtWIvgREZFzY5AiIqIaZ8aMGRg6dCh+//13jBgxAsOGDcOJEycAANnZ2YiNjUWdOnVw4MABrFy5Etu2bTMLSosXL0ZiYiLGjh2Lo0eP4rvvvkPTpk3NjjF79mw89NBDOHLkCPr3748RI0bgxo0byvGPHz+OjRs34sSJE1i8eDHq1atnvx8AERHZnCSEEGoXQUREVFmjRo3C559/Djc3N7P5L774Il588UVIkoSnnnoKixcvVpbdc889+Mc//oFFixbhww8/xLRp03DhwgV4enoCADZs2ICBAwfi0qVLCAoKwl133YXRo0fjtddeK7UGSZLw8ssv49VXXwVgCmdeXl7YuHEj+vXrhwceeAD16tXD//73Pxv9FIiISG08R4qIiJxOr169zIISAPj7+yvTUVFRZsuioqJw+PBhAMCJEyfQvn17JUQBQLdu3WA0GpGUlARJknDp0iX06dOn3BratWunTHt6esLHxwdXrlwBAIwbNw5Dhw7FoUOH0LdvX8THx6Nr165Veq5EROSYGKSIiMjpeHp6luhqZy3u7u6VWs/V1dXssSRJMBqNAIC4uDicP38eGzZswNatW9GnTx8kJiZi/vz5Vq+XiIjUwXOkiIioxvn5559LPG7ZsiUAoGXLlvj999+RnZ2tLN+zZw80Gg1atGgBb29vNGrUCNu3b69WDQEBAUhISMDnn3+OBQsW4IMPPqjW/oiIyLGwRYqIiJxObm4uUlJSzOa5uLgoAzqsXLkSHTt2xL333ovly5dj//79+PjjjwEAI0aMwCuvvIKEhATMmjULV69excSJE/Hoo48iKCgIADBr1iw89dRTCAwMRFxcHDIzM7Fnzx5MnDixUvXNnDkTkZGRaN26NXJzc7F+/XolyBERUc3AIEVERE5n06ZNCAkJMZvXokULnDx5EoBpRL0vv/wS48ePR0hICL744gu0atUKAODh4YHNmzfjmWeeQadOneDh4YGhQ4fiv//9r7KvhIQE5OTk4K233sKzzz6LevXq4cEHH6x0fTqdDtOnT8e5c+fg7u6O7t2748svv7TCMyciIkfBUfuIiKhGkSQJa9asQXx8vNqlEBFRDcZzpIiIiIiIiCzEIEVERERERGQhniNFREQ1CnusExGRPbBFioiIiIiIyEIMUkRERERERBZikCIiIiIiIrIQgxQREREREZGFGKSIiIiIiIgsxCBFRERERERkIQYpIiIiIiIiCzFIERERERERWej/AW4UcUUGdkmVAAAAAElFTkSuQmCC\n"
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 1000x500 with 1 Axes>"
            ],
            "image/png": "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WLdunen/KDk5mccff5yrV68yfvx4fHx8WLZsGTt37szRnoKcV4hioghRSC+//LJy50eoXbt2CqDMnz8/x/pJSUk5lj3//POKg4ODkpKSYlo2bNgwpXLlyqb7ISEhCqCULVtWiYmJMS3/+eefFUD59ddfTcvef//9HG0CFFtbWyU4ONi07NixYwqgzJkzx7SsR48eioODgxIWFmZaduHCBcXa2jrHc+Ymt9c3Y8YMRaPRKFeuXDF7fYAyffp0s3UbNmyoNG7c2HR/48aNCqB8+umnpmUZGRlKmzZtFEBZvHjxPdvUtGlTpWLFioperzct27JliwIo3377rek5U1NTzba7deuWUq5cOeW5554zWw4o77//vun+4sWLFUAJCQlRFEVRIiIiFFtbW6Vbt26KwWAwrffOO+8ogDJs2DDTspSUFLN2KYr6t9bpdGbvzYEDB/J8vXd+Vozv2Ycffmi2Xp8+fRSNRmP2Gcjv5yIvaWlpStmyZZV3333XtGzgwIFK/fr1zdbbuXOnAijjx4/P8RzG9+jChQuKlZWV0qtXrxzvSfb38c7336hy5cpm763x79K6dWslIyPDbN3cPqd79+5VAOWHH34wLZsyZYoCKOvXr8+z3Vu3blUA5ffffzd7vF69ekq7du1ybJdbu7t162a2bNasWQqgLF++3LQsLS1NadmypeLk5KTEx8cripJ1XHBxcVEiIiLuua/sDh48qLz44ouKq6urAiiNGzdW5s6da3Z8KYrtcnt92X355ZcKoPz888+KoijK7t27FUBZsWKF2XrG/9nsyytXrqwAyt9//21aFhERoeh0OuX11183Latfv/5d26AoivL4448rgYGBZsdhg8GgtGrVSqlWrZpp2Z9//qkAytq1a5XY2FilTJkyylNPPWV6fNiwYYqjo6Pp/u3btxU3Nzdl9OjRZvu7ceOG4urqarY8t++TvERHRyteXl5KmzZtzJbXqVNH6dixY471T506lef3kqIoSrdu3cyOI3nZv3+/8sILLyhubm4KoDRs2FD5+uuvlVu3bj2Q7YzWrl2rAMrp06cVRVGUX375RdHpdMpTTz2l9OvXz7RevXr1lF69epnu33l8VhT1Pcrtf9O4bqdOncyOOa+++qqi1WqV2NjYu7bR+N0bGRmpTJw4UQkICDA91rRpU2XEiBGKoqjHsJdffvmubVSUrM/a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+Y1WrFih9957TwkJCZo4caJqa2vDXCk6I9jnLEmTJk1q9t1+6aWXwlghOmvr1q0qLi7W9u3b9cYbb6ihoUG33XabvF5v4DkPPfSQ/vSnP2nt2rXaunWrjh07punTpztYNULRns9YkubNm9fsu/zUU085VDE6on///vr5z3+unTt36n/+53906623aurUqfrwww8l2fA9NuCIsWPHGsXFxYFfNzY2GllZWUZZWZmDVcFKpaWlRm5urtNlwCaSjPXr1wd+7fP5jIyMDOOXv/xl4L5z584ZHo/HeOmllxyoEFb48udsGIZRVFRkTJ061ZF6YI+TJ08akoytW7cahuH/7kZHRxtr164NPGffvn2GJGPbtm1OlYlO+PJnbBiGcfPNNxsLFixwrijYIjk52fiP//gPW77HrDg5oL6+Xjt37lRhYWHgPrfbrcLCQm3bts3BymC1Tz75RFlZWRoyZIhmzZqlw4cPO10SbPL3v/9dFRUVzb7XSUlJys/P53vdBW3ZskVpaWnKycnR/fffrzNnzjhdEjqhsrJSkpSSkiJJ2rlzpxoaGpp9n6+77joNHDiQ7/NV6sufsemPf/yjUlNTNWrUKC1cuFDnz593ojxYoLGxUatXr5bX61VBQYEt3+MeVhWL9jt9+rQaGxuVnp7e7P709HR99NFHDlUFq+Xn5+u5555TTk6Ojh8/riVLluimm27SBx98oJ49ezpdHixWUVEhSa1+r83H0DVMmjRJ06dP1+DBg3Xw4EE9+uijmjx5srZt26aoqCiny0OIfD6ffvjDH2r8+PEaNWqUJP/3OSYmRr179272XL7PV6fWPmNJ+u53v6vs7GxlZWVpz549euSRR7R//369/PLLDlaLUO3du1cFBQWqra1VYmKi1q9frxEjRmj37t2Wf48JToBNJk+eHDgePXq08vPzlZ2drf/8z//U3LlzHawMQGfcfffdgePrr79eo0eP1jXXXKMtW7ZowoQJDlaGjiguLtYHH3zANahd2JU+43vvvTdwfP311yszM1MTJkzQwYMHdc0114S7THRQTk6Odu/ercrKSq1bt05FRUXaunWrLeeiVc8BqampioqKajHV48SJE8rIyHCoKtitd+/euvbaa3XgwAGnS4ENzO8u3+vuZ8iQIUpNTeW7fRWaP3++XnvtNb311lvq379/4P6MjAzV19fr3LlzzZ7P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\n"
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "import plotly.graph_objs as go\n",
        "classes = range(7)\n",
        "\n",
        "Y_pred = model_dense.predict([X_test_image, encoded_test])\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<DenseNet201>> with Multi_modal: \")\n",
        "print(report)\n"
      ],
      "metadata": {
        "id": "gb-QfpKTfdIy",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 820
        },
        "outputId": "eecc6e1d-a4ab-4878-dbee-9e85df257ec0"
      },
      "execution_count": 32,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "63/63 [==============================] - 9s 89ms/step\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.24.1.min.js\"></script>                <div id=\"2a503ac2-a4b6-4456-adf0-aae5344d8294\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"2a503ac2-a4b6-4456-adf0-aae5344d8294\")) {                    Plotly.newPlot(                        \"2a503ac2-a4b6-4456-adf0-aae5344d8294\",                        [{\"colorbar\":{\"title\":{\"text\":\"Count\"}},\"colorscale\":[[0.0,\"#fcfdbf\"],[0.1111111111111111,\"#feca8d\"],[0.2222222222222222,\"#fd9668\"],[0.3333333333333333,\"#f1605d\"],[0.4444444444444444,\"#cd4071\"],[0.5555555555555556,\"#9e2f7f\"],[0.6666666666666666,\"#721f81\"],[0.7777777777777778,\"#440f76\"],[0.8888888888888888,\"#180f3d\"],[1.0,\"#000004\"]],\"hoverinfo\":\"z\",\"showscale\":true,\"x\":[0,1,2,3,4,5,6],\"y\":[0,1,2,3,4,5,6],\"z\":[[1219,51,21,5,3,1,5],[46,164,14,5,6,0,2],[34,28,142,7,10,0,7],[6,0,6,83,6,1,7],[0,5,11,3,45,0,4],[0,1,0,1,0,29,0],[1,0,0,0,2,0,22]],\"type\":\"heatmap\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"title\":{\"text\":\"Confusion Matrix (Counts)\"},\"xaxis\":{\"title\":{\"text\":\"Predicted label\"}},\"yaxis\":{\"title\":{\"text\":\"True label\"}},\"annotations\":[{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1219\",\"x\":0,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"51\",\"x\":1,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"21\",\"x\":2,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"5\",\"x\":3,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"3\",\"x\":4,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1\",\"x\":5,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"5\",\"x\":6,\"y\":0},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"46\",\"x\":0,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"164\",\"x\":1,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"14\",\"x\":2,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"5\",\"x\":3,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"6\",\"x\":4,\"y\":1},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"2\",\"x\":6,\"y\":1},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"34\",\"x\":0,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"28\",\"x\":1,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"142\",\"x\":2,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"7\",\"x\":3,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"10\",\"x\":4,\"y\":2},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"7\",\"x\":6,\"y\":2},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"6\",\"x\":0,\"y\":3},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":1,\"y\":3},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"6\",\"x\":2,\"y\":3},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"83\",\"x\":3,\"y\":3},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"6\",\"x\":4,\"y\":3},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1\",\"x\":5,\"y\":3},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"7\",\"x\":6,\"y\":3},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":0,\"y\":4},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"5\",\"x\":1,\"y\":4},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"11\",\"x\":2,\"y\":4},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"3\",\"x\":3,\"y\":4},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"45\",\"x\":4,\"y\":4},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"y\":4},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"4\",\"x\":6,\"y\":4},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":0,\"y\":5},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1\",\"x\":1,\"y\":5},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":2,\"y\":5},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1\",\"x\":3,\"y\":5},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"y\":5},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"29\",\"x\":5,\"y\":5},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":6,\"y\":5},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"1\",\"x\":0,\"y\":6},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":1,\"y\":6},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":2,\"y\":6},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":3,\"y\":6},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"2\",\"x\":4,\"y\":6},{\"font\":{\"color\":\"black\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"y\":6},{\"font\":{\"color\":\"red\"},\"showarrow\":false,\"text\":\"22\",\"x\":6,\"y\":6}]},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('2a503ac2-a4b6-4456-adf0-aae5344d8294');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Classification Report for <<DenseNet201>> with Multi_modal: \n",
            "              precision    recall  f1-score   support\n",
            "\n",
            "           0       0.93      0.93      0.93      1305\n",
            "           1       0.66      0.69      0.67       237\n",
            "           2       0.73      0.62      0.67       228\n",
            "           3       0.80      0.76      0.78       109\n",
            "           4       0.62      0.66      0.64        68\n",
            "           5       0.94      0.94      0.94        31\n",
            "           6       0.47      0.88      0.61        25\n",
            "\n",
            "    accuracy                           0.85      2003\n",
            "   macro avg       0.74      0.78      0.75      2003\n",
            "weighted avg       0.85      0.85      0.85      2003\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "Xf5CoKP7PuCD"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### REsnet50 model - multi-modal"
      ],
      "metadata": {
        "id": "Y4UVoKQi4D4r"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "\n",
        "### TODO: Check point model plz resnet50\n",
        "from tensorflow.keras.callbacks import ModelCheckpoint\n",
        "\n",
        "model_filepath = \"/content/drive/MyDrive/HAMdatset/model-{epoch:02d}-{val_accuracy:.4f}.hdf5\"\n",
        "\n",
        "#Saves model when the validation accuracy is improving\n",
        "checkpoint = ModelCheckpoint(\n",
        "    filepath = model_filepath,\n",
        "    monitor='val_accuracy',\n",
        "    mode='max',\n",
        "    save_best_only=True,\n",
        "    verbose=1\n",
        ")\n",
        "'''\n"
      ],
      "metadata": {
        "id": "4XzsJHi4v35X"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Input, Concatenate\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "\n",
        "categorical_input = Input(shape=(20,))\n",
        "\n",
        "# Load the pre-trained DenseNet-121 model (Same as before)\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# After GlobalAveragePooling2D layer, concatenate with the categorical input\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\n",
        "\n",
        "# Add Custom Layers for Categorical Data\n",
        "y = Dense(64, activation='relu')(categorical_input)\n",
        "x = Concatenate()([x, y])\n",
        "\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model with both image and categorical inputs\n",
        "model_resnet = Model(inputs=[base_model.input, categorical_input], outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,\n",
        "    decay_rate=0.9\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_resnet.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n",
        "'''"
      ],
      "metadata": {
        "id": "gaaPUdVtfbYP"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "\n",
        "# Train the model with data augmentation and callbacks\n",
        "### TODO: Put in check point in callback\n",
        "\n",
        "epochs = 60\n",
        "batch_size = 60\n",
        "history = model_resnet.fit(\n",
        "    [X_train_image, encoded_train],  # Update with your actual image and categorical training data\n",
        "    y_train, epochs=epochs, batch_size=batch_size,\n",
        "    callbacks=[learning_rate_reduction , early_stopping, checkpoint], validation_data=([X_test_image, encoded_test], y_test)\n",
        ")\n",
        "\n",
        "# Plot the training and validation loss\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss for <<ResNet50>> using Multi-Modal : ')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy for <<ResNet50>> using Multi-Modal : ')\n",
        "plt.show()\n",
        "'''"
      ],
      "metadata": {
        "id": "yG7xErKRknTy"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "\n",
        "Y_pred = model_resnet.predict([X_test_image, encoded_test])\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> using Multi-Modal : \")\n",
        "print(report)\n",
        "'''"
      ],
      "metadata": {
        "id": "yPjv3nSFknex"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Predict with new data - preprocess ISIC-images data"
      ],
      "metadata": {
        "id": "z-lIrjfS22q2"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "new_data = pd.read_csv('new_data.csv')"
      ],
      "metadata": {
        "id": "4PjxPHkHPvAR"
      },
      "execution_count": 89,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "bq4SbOnlaXuv",
        "outputId": "fe063a11-c65f-4663-e007-9a13f4295349"
      },
      "execution_count": 90,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           isic_id                        attribution copyright_license  \\\n",
              "0     ISIC_0079358  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "1     ISIC_0086914  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "2     ISIC_0088904  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "3     ISIC_0094098  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "4     ISIC_0095134  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "...            ...                                ...               ...   \n",
              "1611  ISIC_9989778  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "1612  ISIC_9995847  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "1613  ISIC_9997367  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "1614  ISIC_9998679  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "1615  ISIC_9999251  Hospital Italiano de Buenos Aires             CC-BY   \n",
              "\n",
              "      age_approx anatom_site_general benign_malignant   dermoscopic_type  \\\n",
              "0           35.0      anterior torso           benign  contact polarized   \n",
              "1           55.0     upper extremity        malignant  contact polarized   \n",
              "2           50.0                 NaN        malignant  contact polarized   \n",
              "3           65.0     posterior torso        malignant                NaN   \n",
              "4           70.0      anterior torso        malignant  contact polarized   \n",
              "...          ...                 ...              ...                ...   \n",
              "1611        40.0                 NaN           benign  contact polarized   \n",
              "1612        75.0     upper extremity           benign  contact polarized   \n",
              "1613        70.0           head/neck           benign                NaN   \n",
              "1614        65.0           head/neck        malignant  contact polarized   \n",
              "1615        65.0     lower extremity           benign  contact polarized   \n",
              "\n",
              "                 diagnosis diagnosis_confirm_type family_hx_mm  \\\n",
              "0                    nevus                    NaN        False   \n",
              "1     basal cell carcinoma         histopathology        False   \n",
              "2     basal cell carcinoma         histopathology        False   \n",
              "3                 melanoma         histopathology        False   \n",
              "4                 melanoma         histopathology        False   \n",
              "...                    ...                    ...          ...   \n",
              "1611                 nevus                    NaN        False   \n",
              "1612       vascular lesion         histopathology          NaN   \n",
              "1613     actinic keratosis                    NaN          NaN   \n",
              "1614  basal cell carcinoma         histopathology          NaN   \n",
              "1615     actinic keratosis         histopathology        False   \n",
              "\n",
              "              image_type   lesion_id  patient_id personal_hx_mm     sex  \n",
              "0            dermoscopic  IL_3989348  IP_9328831          False  female  \n",
              "1            dermoscopic  IL_9767756  IP_7506563           True    male  \n",
              "2            dermoscopic  IL_8711401  IP_0222733          False  female  \n",
              "3     clinical: overview  IL_6961144  IP_1218261           True    male  \n",
              "4            dermoscopic  IL_4530268  IP_8235588           True  female  \n",
              "...                  ...         ...         ...            ...     ...  \n",
              "1611         dermoscopic  IL_8944708  IP_1404370          False    male  \n",
              "1612         dermoscopic  IL_1047690  IP_8538177            NaN  female  \n",
              "1613  clinical: overview  IL_1956821  IP_2692251            NaN  female  \n",
              "1614         dermoscopic  IL_3341905  IP_5842685            NaN  female  \n",
              "1615         dermoscopic  IL_1343671  IP_3975331           True  female  \n",
              "\n",
              "[1616 rows x 15 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-823be7d8-4fd8-4869-b993-f92f1c02ac30\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>isic_id</th>\n",
              "      <th>attribution</th>\n",
              "      <th>copyright_license</th>\n",
              "      <th>age_approx</th>\n",
              "      <th>anatom_site_general</th>\n",
              "      <th>benign_malignant</th>\n",
              "      <th>dermoscopic_type</th>\n",
              "      <th>diagnosis</th>\n",
              "      <th>diagnosis_confirm_type</th>\n",
              "      <th>family_hx_mm</th>\n",
              "      <th>image_type</th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>patient_id</th>\n",
              "      <th>personal_hx_mm</th>\n",
              "      <th>sex</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>ISIC_0079358</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>35.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>benign</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>nevus</td>\n",
              "      <td>NaN</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_3989348</td>\n",
              "      <td>IP_9328831</td>\n",
              "      <td>False</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>ISIC_0086914</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>55.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>malignant</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_9767756</td>\n",
              "      <td>IP_7506563</td>\n",
              "      <td>True</td>\n",
              "      <td>male</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>ISIC_0088904</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>50.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>malignant</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_8711401</td>\n",
              "      <td>IP_0222733</td>\n",
              "      <td>False</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>ISIC_0094098</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>65.0</td>\n",
              "      <td>posterior torso</td>\n",
              "      <td>malignant</td>\n",
              "      <td>NaN</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>False</td>\n",
              "      <td>clinical: overview</td>\n",
              "      <td>IL_6961144</td>\n",
              "      <td>IP_1218261</td>\n",
              "      <td>True</td>\n",
              "      <td>male</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>ISIC_0095134</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>70.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>malignant</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_4530268</td>\n",
              "      <td>IP_8235588</td>\n",
              "      <td>True</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1611</th>\n",
              "      <td>ISIC_9989778</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>40.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>benign</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>nevus</td>\n",
              "      <td>NaN</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_8944708</td>\n",
              "      <td>IP_1404370</td>\n",
              "      <td>False</td>\n",
              "      <td>male</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1612</th>\n",
              "      <td>ISIC_9995847</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>75.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>benign</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>vascular lesion</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>NaN</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_1047690</td>\n",
              "      <td>IP_8538177</td>\n",
              "      <td>NaN</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1613</th>\n",
              "      <td>ISIC_9997367</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>70.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>benign</td>\n",
              "      <td>NaN</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>clinical: overview</td>\n",
              "      <td>IL_1956821</td>\n",
              "      <td>IP_2692251</td>\n",
              "      <td>NaN</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1614</th>\n",
              "      <td>ISIC_9998679</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>65.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>malignant</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>NaN</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_3341905</td>\n",
              "      <td>IP_5842685</td>\n",
              "      <td>NaN</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1615</th>\n",
              "      <td>ISIC_9999251</td>\n",
              "      <td>Hospital Italiano de Buenos Aires</td>\n",
              "      <td>CC-BY</td>\n",
              "      <td>65.0</td>\n",
              "      <td>lower extremity</td>\n",
              "      <td>benign</td>\n",
              "      <td>contact polarized</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>histopathology</td>\n",
              "      <td>False</td>\n",
              "      <td>dermoscopic</td>\n",
              "      <td>IL_1343671</td>\n",
              "      <td>IP_3975331</td>\n",
              "      <td>True</td>\n",
              "      <td>female</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1616 rows × 15 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-823be7d8-4fd8-4869-b993-f92f1c02ac30')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-823be7d8-4fd8-4869-b993-f92f1c02ac30 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-823be7d8-4fd8-4869-b993-f92f1c02ac30');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-f60c1e73-0885-4dd5-bfed-3e91b8772cd3\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f60c1e73-0885-4dd5-bfed-3e91b8772cd3')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-f60c1e73-0885-4dd5-bfed-3e91b8772cd3 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_1b9e66c9-8b1a-4bde-b032-1116b615d2ca\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('new_data')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_1b9e66c9-8b1a-4bde-b032-1116b615d2ca button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('new_data');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 90
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## TODO: So I only extract these columns out but I i think we need to extract Lession ID as well. --> just to fit with HAM10000 meta data.\n",
        "new_data = new_data[['isic_id', 'age_approx','anatom_site_general','diagnosis','sex' ,'diagnosis_confirm_type','lesion_id']]"
      ],
      "metadata": {
        "id": "viddpxKsVBlh"
      },
      "execution_count": 91,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data['diagnosis_confirm_type'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "7d1i7NDXnczK",
        "outputId": "9e7cf710-b84a-4c3d-c19d-0022ad5667c1"
      },
      "execution_count": 92,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([nan, 'histopathology', 'single image expert consensus'],\n",
              "      dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 92
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "meta['dx_type'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "zkXJElrSnc1_",
        "outputId": "3ad486f5-fb78-48e7-cee0-d3527acde627"
      },
      "execution_count": 93,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['histo', 'consensus', 'confocal', 'follow_up'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 93
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Mapping proposal :\n",
        "histopathology --> histo\n",
        "\n",
        "single image expert consensus --> consensus\n",
        "\n",
        "nan --> mode\n"
      ],
      "metadata": {
        "id": "AGvI5pccnxut"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "\n",
        "# Assuming 'meta' and 'new_data' are predefined DataFrames\n",
        "# and 'diagnosis_confirm_type' is a column in 'new_data'\n",
        "\n",
        "# Create a copy of new_data to work with\n",
        "new_data_copy = new_data.copy()\n",
        "\n",
        "# Determine the most frequent value in meta['dx_type']\n",
        "most_frequent = pd.Series(meta['dx_type']).value_counts().idxmax()\n",
        "\n",
        "# Create a mapping dictionary\n",
        "mapping = {\n",
        "    'histopathology': 'histo',\n",
        "    'single image expert consensus': 'consensus'\n",
        "}\n",
        "\n",
        "# Replace NaN values in new_data_copy['diagnosis_confirm_type'] with the most frequent value from 'meta'\n",
        "new_data_copy['diagnosis_confirm_type'] = new_data_copy['diagnosis_confirm_type'].fillna(most_frequent)\n",
        "\n",
        "# Apply the mapping to the 'diagnosis_confirm_type' column\n",
        "new_data_copy['diagnosis_confirm_type'] = new_data_copy['diagnosis_confirm_type'].map(mapping)\n"
      ],
      "metadata": {
        "id": "SzSL5fsqn9SR"
      },
      "execution_count": 94,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "jgoGeu4OpFs6"
      },
      "execution_count": 94,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data = new_data_copy"
      ],
      "metadata": {
        "id": "HatF9Ox6pAe0"
      },
      "execution_count": 95,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Rename 'diagnosis_confirm_type' column to 'dx_type' in new_data DataFrame\n",
        "new_data.rename(columns={'diagnosis_confirm_type': 'dx_type'}, inplace=True)\n",
        "\n"
      ],
      "metadata": {
        "id": "mFC9SKT9olGe"
      },
      "execution_count": 96,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data['dx_type'].fillna('histo', inplace=True)\n"
      ],
      "metadata": {
        "id": "Ysv9LMednc4m"
      },
      "execution_count": 97,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "mpkshy3GpX4L",
        "outputId": "08b44953-00ec-40fc-f433-5ef3a3711670"
      },
      "execution_count": 98,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           isic_id  age_approx anatom_site_general             diagnosis  \\\n",
              "0     ISIC_0079358        35.0      anterior torso                 nevus   \n",
              "1     ISIC_0086914        55.0     upper extremity  basal cell carcinoma   \n",
              "2     ISIC_0088904        50.0                 NaN  basal cell carcinoma   \n",
              "3     ISIC_0094098        65.0     posterior torso              melanoma   \n",
              "4     ISIC_0095134        70.0      anterior torso              melanoma   \n",
              "...            ...         ...                 ...                   ...   \n",
              "1611  ISIC_9989778        40.0                 NaN                 nevus   \n",
              "1612  ISIC_9995847        75.0     upper extremity       vascular lesion   \n",
              "1613  ISIC_9997367        70.0           head/neck     actinic keratosis   \n",
              "1614  ISIC_9998679        65.0           head/neck  basal cell carcinoma   \n",
              "1615  ISIC_9999251        65.0     lower extremity     actinic keratosis   \n",
              "\n",
              "         sex dx_type   lesion_id  \n",
              "0     female   histo  IL_3989348  \n",
              "1       male   histo  IL_9767756  \n",
              "2     female   histo  IL_8711401  \n",
              "3       male   histo  IL_6961144  \n",
              "4     female   histo  IL_4530268  \n",
              "...      ...     ...         ...  \n",
              "1611    male   histo  IL_8944708  \n",
              "1612  female   histo  IL_1047690  \n",
              "1613  female   histo  IL_1956821  \n",
              "1614  female   histo  IL_3341905  \n",
              "1615  female   histo  IL_1343671  \n",
              "\n",
              "[1616 rows x 7 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-6e70877f-3d81-4e03-929d-bf0e29a7aea7\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>isic_id</th>\n",
              "      <th>age_approx</th>\n",
              "      <th>anatom_site_general</th>\n",
              "      <th>diagnosis</th>\n",
              "      <th>sex</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>lesion_id</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>ISIC_0079358</td>\n",
              "      <td>35.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>nevus</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3989348</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>ISIC_0086914</td>\n",
              "      <td>55.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_9767756</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>ISIC_0088904</td>\n",
              "      <td>50.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8711401</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>ISIC_0094098</td>\n",
              "      <td>65.0</td>\n",
              "      <td>posterior torso</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_6961144</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>ISIC_0095134</td>\n",
              "      <td>70.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_4530268</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1611</th>\n",
              "      <td>ISIC_9989778</td>\n",
              "      <td>40.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>nevus</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8944708</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1612</th>\n",
              "      <td>ISIC_9995847</td>\n",
              "      <td>75.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>vascular lesion</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1047690</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1613</th>\n",
              "      <td>ISIC_9997367</td>\n",
              "      <td>70.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1956821</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1614</th>\n",
              "      <td>ISIC_9998679</td>\n",
              "      <td>65.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3341905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1615</th>\n",
              "      <td>ISIC_9999251</td>\n",
              "      <td>65.0</td>\n",
              "      <td>lower extremity</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1343671</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1616 rows × 7 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6e70877f-3d81-4e03-929d-bf0e29a7aea7')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-6e70877f-3d81-4e03-929d-bf0e29a7aea7 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-6e70877f-3d81-4e03-929d-bf0e29a7aea7');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-7489c317-24ae-490b-abb8-9cb3f9f9871f\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-7489c317-24ae-490b-abb8-9cb3f9f9871f')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-7489c317-24ae-490b-abb8-9cb3f9f9871f button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_2852f005-a9f9-401c-8654-c691f71e5d4a\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('new_data')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_2852f005-a9f9-401c-8654-c691f71e5d4a button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('new_data');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 98
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data.isnull().sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Dn1Xe88CVBoH",
        "outputId": "efd341df-f682-492f-ed1f-98317f4a3160"
      },
      "execution_count": 99,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "isic_id                  0\n",
              "age_approx               5\n",
              "anatom_site_general    110\n",
              "diagnosis                0\n",
              "sex                      5\n",
              "dx_type                  0\n",
              "lesion_id                0\n",
              "dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 99
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data = new_data.rename(columns={\n",
        "    'isic_id': 'image_id',\n",
        "    'age_approx': 'age',\n",
        "    'anatom_site_general': 'localization',\n",
        "    'diagnosis': 'dx'\n",
        "})"
      ],
      "metadata": {
        "id": "YsKUvMZrVBr5"
      },
      "execution_count": 100,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "0kCEL2jpVBtK",
        "outputId": "58202810-9d5b-4604-ff85-8981e6e013a3"
      },
      "execution_count": 101,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "          image_id   age     localization                    dx     sex  \\\n",
              "0     ISIC_0079358  35.0   anterior torso                 nevus  female   \n",
              "1     ISIC_0086914  55.0  upper extremity  basal cell carcinoma    male   \n",
              "2     ISIC_0088904  50.0              NaN  basal cell carcinoma  female   \n",
              "3     ISIC_0094098  65.0  posterior torso              melanoma    male   \n",
              "4     ISIC_0095134  70.0   anterior torso              melanoma  female   \n",
              "...            ...   ...              ...                   ...     ...   \n",
              "1611  ISIC_9989778  40.0              NaN                 nevus    male   \n",
              "1612  ISIC_9995847  75.0  upper extremity       vascular lesion  female   \n",
              "1613  ISIC_9997367  70.0        head/neck     actinic keratosis  female   \n",
              "1614  ISIC_9998679  65.0        head/neck  basal cell carcinoma  female   \n",
              "1615  ISIC_9999251  65.0  lower extremity     actinic keratosis  female   \n",
              "\n",
              "     dx_type   lesion_id  \n",
              "0      histo  IL_3989348  \n",
              "1      histo  IL_9767756  \n",
              "2      histo  IL_8711401  \n",
              "3      histo  IL_6961144  \n",
              "4      histo  IL_4530268  \n",
              "...      ...         ...  \n",
              "1611   histo  IL_8944708  \n",
              "1612   histo  IL_1047690  \n",
              "1613   histo  IL_1956821  \n",
              "1614   histo  IL_3341905  \n",
              "1615   histo  IL_1343671  \n",
              "\n",
              "[1616 rows x 7 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-975a4401-b078-4f38-b384-3530da4ff8e5\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>image_id</th>\n",
              "      <th>age</th>\n",
              "      <th>localization</th>\n",
              "      <th>dx</th>\n",
              "      <th>sex</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>lesion_id</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>ISIC_0079358</td>\n",
              "      <td>35.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>nevus</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3989348</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>ISIC_0086914</td>\n",
              "      <td>55.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_9767756</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>ISIC_0088904</td>\n",
              "      <td>50.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8711401</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>ISIC_0094098</td>\n",
              "      <td>65.0</td>\n",
              "      <td>posterior torso</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_6961144</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>ISIC_0095134</td>\n",
              "      <td>70.0</td>\n",
              "      <td>anterior torso</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_4530268</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1611</th>\n",
              "      <td>ISIC_9989778</td>\n",
              "      <td>40.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>nevus</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8944708</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1612</th>\n",
              "      <td>ISIC_9995847</td>\n",
              "      <td>75.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>vascular lesion</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1047690</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1613</th>\n",
              "      <td>ISIC_9997367</td>\n",
              "      <td>70.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1956821</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1614</th>\n",
              "      <td>ISIC_9998679</td>\n",
              "      <td>65.0</td>\n",
              "      <td>head/neck</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3341905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1615</th>\n",
              "      <td>ISIC_9999251</td>\n",
              "      <td>65.0</td>\n",
              "      <td>lower extremity</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1343671</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1616 rows × 7 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-975a4401-b078-4f38-b384-3530da4ff8e5')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-975a4401-b078-4f38-b384-3530da4ff8e5 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-975a4401-b078-4f38-b384-3530da4ff8e5');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-ec13302c-8b78-4814-bc7c-b747c117e970\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ec13302c-8b78-4814-bc7c-b747c117e970')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-ec13302c-8b78-4814-bc7c-b747c117e970 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_44d10d97-7d7a-41a0-aa5a-c559fc79ca75\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('new_data')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_44d10d97-7d7a-41a0-aa5a-c559fc79ca75 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('new_data');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 101
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Replace null with mean\n",
        "new_data['age'].fillna((new_data['age'].mean()), inplace=True)"
      ],
      "metadata": {
        "id": "mdmuV4oi5gCY"
      },
      "execution_count": 102,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## fill in sex randomly + localization will be filled in\n",
        "new_data.isnull().sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "8ivs7qhIWPY1",
        "outputId": "ab296e94-2ff6-49ec-fbb5-5274d26081a6"
      },
      "execution_count": 103,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "image_id          0\n",
              "age               0\n",
              "localization    110\n",
              "dx                0\n",
              "sex               5\n",
              "dx_type           0\n",
              "lesion_id         0\n",
              "dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 103
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "import random\n",
        "\n",
        "# fill in sex randomly\n",
        "new_data['sex'] = new_data['sex'].apply(lambda x: random.choice(['female', 'male']) if pd.isna(x) else x)\n"
      ],
      "metadata": {
        "id": "y9uqPnRNW2nt"
      },
      "execution_count": 104,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data.isnull().sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "AnWwCwgfW8o9",
        "outputId": "ff5cb92e-c555-4b54-9881-3d480756ac88"
      },
      "execution_count": 105,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "image_id          0\n",
              "age               0\n",
              "localization    110\n",
              "dx                0\n",
              "sex               0\n",
              "dx_type           0\n",
              "lesion_id         0\n",
              "dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 105
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data['localization'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Px9RrD11W8rP",
        "outputId": "fbeff219-89d9-4d48-fdfb-66cc6a539853"
      },
      "execution_count": 106,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['anterior torso', 'upper extremity', nan, 'posterior torso',\n",
              "       'lower extremity', 'lateral torso', 'head/neck', 'oral/genital',\n",
              "       'palms/soles'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 106
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "meta['localization'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "P0ISUl0qW8tS",
        "outputId": "53a0f332-eb7c-4ee7-e80a-397b08769213"
      },
      "execution_count": 107,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['scalp', 'ear', 'face', 'back', 'trunk', 'chest',\n",
              "       'upper extremity', 'abdomen', 'unknown', 'lower extremity',\n",
              "       'genital', 'neck', 'hand', 'foot', 'acral'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 107
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Mapping proposal :\n",
        "anterior torso →  abdomen\n",
        "\n",
        "upper extremity → upper extremity\n",
        "\n",
        "posterior torso → back\n",
        "\n",
        "lower extremity → lower extremity\n",
        "\n",
        "lateral torso → trunk\n",
        "\n",
        "head/neck →  face\n",
        "\n",
        "oral/genital → genital\n",
        "\n",
        "palms/soles →  acral\n",
        "\n",
        "nan (Not a Number, which represents missing data) → mode value"
      ],
      "metadata": {
        "id": "WA_KonSGXXRr"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "\n",
        "# Determine the most frequent value in meta['localization']\n",
        "most_frequent = pd.Series(meta['localization']).value_counts().idxmax()\n",
        "\n",
        "# Create a mapping dictionary\n",
        "# This is an example, adjust it according to your actual data\n",
        "mapping = {\n",
        "    'anterior torso': 'abdomen',\n",
        "\n",
        "    'upper extremity': 'upper extremity',\n",
        "\n",
        "    'posterior torso': 'back',\n",
        "\n",
        "    'lower extremity': 'lower extremity',\n",
        "\n",
        "    'lateral torso': 'trunk',\n",
        "    'head/neck': 'face',\n",
        "    'oral/genital': 'genital',\n",
        "\n",
        "    'palms/soles': 'acral'}\n",
        "\n",
        "# Replace NaN values in new_data['localization'] with the most frequent value\n",
        "new_data['localization'] = new_data['localization'].fillna(most_frequent)\n",
        "\n",
        "# Apply the mapping\n",
        "new_data['localization'] = new_data['localization'].map(mapping)\n",
        "\n",
        "# If there are any unmapped values, you might want to handle them too\n",
        "# For example, replace them with 'unknown' or most frequent value\n",
        "new_data['localization'].fillna('unknown', inplace=True)\n"
      ],
      "metadata": {
        "id": "0qBNoEyKXg0a"
      },
      "execution_count": 108,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data[:3]"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 143
        },
        "id": "U4nJRugR7yWN",
        "outputId": "8e78c82b-9dda-4b06-a4fd-36b3df9e06e9"
      },
      "execution_count": 149,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "       image_id   age     localization   dx     sex dx_type   lesion_id  \\\n",
              "0  ISIC_0079358  35.0          abdomen   nv  female   histo  IL_3989348   \n",
              "1  ISIC_0086914  55.0  upper extremity  bcc    male   histo  IL_9767756   \n",
              "2  ISIC_0088904  50.0          unknown  bcc  female   histo  IL_8711401   \n",
              "\n",
              "                                                path  \\\n",
              "0  /content/drive/My Drive/ISIC-images/ISIC_00793...   \n",
              "1  /content/drive/My Drive/ISIC-images/ISIC_00869...   \n",
              "2  /content/drive/My Drive/ISIC-images/ISIC_00889...   \n",
              "\n",
              "                                               image  dx_code  \n",
              "0  [[[0.015686275, 0.007843138, 0.011764706], [0....      0.0  \n",
              "1  [[[0.38039216, 0.25882354, 0.29803923], [0.384...      3.0  \n",
              "2  [[[0.20392157, 0.21960784, 0.26666668], [0.325...      3.0  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-f719d1ac-10f5-44e0-a666-5c79d4a3e380\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>image_id</th>\n",
              "      <th>age</th>\n",
              "      <th>localization</th>\n",
              "      <th>dx</th>\n",
              "      <th>sex</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>path</th>\n",
              "      <th>image</th>\n",
              "      <th>dx_code</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>ISIC_0079358</td>\n",
              "      <td>35.0</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>nv</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3989348</td>\n",
              "      <td>/content/drive/My Drive/ISIC-images/ISIC_00793...</td>\n",
              "      <td>[[[0.015686275, 0.007843138, 0.011764706], [0....</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>ISIC_0086914</td>\n",
              "      <td>55.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>bcc</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_9767756</td>\n",
              "      <td>/content/drive/My Drive/ISIC-images/ISIC_00869...</td>\n",
              "      <td>[[[0.38039216, 0.25882354, 0.29803923], [0.384...</td>\n",
              "      <td>3.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>ISIC_0088904</td>\n",
              "      <td>50.0</td>\n",
              "      <td>unknown</td>\n",
              "      <td>bcc</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8711401</td>\n",
              "      <td>/content/drive/My Drive/ISIC-images/ISIC_00889...</td>\n",
              "      <td>[[[0.20392157, 0.21960784, 0.26666668], [0.325...</td>\n",
              "      <td>3.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f719d1ac-10f5-44e0-a666-5c79d4a3e380')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-f719d1ac-10f5-44e0-a666-5c79d4a3e380 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-f719d1ac-10f5-44e0-a666-5c79d4a3e380');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-b90ba6ce-fbec-46bc-8a6a-a6be8027e009\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-b90ba6ce-fbec-46bc-8a6a-a6be8027e009')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-b90ba6ce-fbec-46bc-8a6a-a6be8027e009 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 149
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "meta[:3]"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 143
        },
        "id": "SCtgcEPA71O-",
        "outputId": "86d1a69b-ccbf-432b-cdd4-4b782e919bcd"
      },
      "execution_count": 150,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     lesion_id      image_id   dx dx_type   age   sex localization  \\\n",
              "0  HAM_0000118  ISIC_0027419  bkl   histo  80.0  male        scalp   \n",
              "1  HAM_0000118  ISIC_0025030  bkl   histo  80.0  male        scalp   \n",
              "2  HAM_0002730  ISIC_0026769  bkl   histo  80.0  male        scalp   \n",
              "\n",
              "                                               path  dx_code  \\\n",
              "0  /content/HAM10000_images_part_1/ISIC_0027419.jpg        2   \n",
              "1  /content/HAM10000_images_part_1/ISIC_0025030.jpg        2   \n",
              "2  /content/HAM10000_images_part_1/ISIC_0026769.jpg        2   \n",
              "\n",
              "                                               image  \n",
              "0  [[[0.74509805, 0.6, 0.7607843], [0.7529412, 0....  \n",
              "1  [[[0.09019608, 0.050980393, 0.08627451], [0.09...  \n",
              "2  [[[0.7254902, 0.49803922, 0.5372549], [0.74117...  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-0a157e2e-04f2-4e2f-be61-0542c65c4ed2\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>lesion_id</th>\n",
              "      <th>image_id</th>\n",
              "      <th>dx</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>age</th>\n",
              "      <th>sex</th>\n",
              "      <th>localization</th>\n",
              "      <th>path</th>\n",
              "      <th>dx_code</th>\n",
              "      <th>image</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0027419</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0027419.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.74509805, 0.6, 0.7607843], [0.7529412, 0....</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>HAM_0000118</td>\n",
              "      <td>ISIC_0025030</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0025030.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.09019608, 0.050980393, 0.08627451], [0.09...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>HAM_0002730</td>\n",
              "      <td>ISIC_0026769</td>\n",
              "      <td>bkl</td>\n",
              "      <td>histo</td>\n",
              "      <td>80.0</td>\n",
              "      <td>male</td>\n",
              "      <td>scalp</td>\n",
              "      <td>/content/HAM10000_images_part_1/ISIC_0026769.jpg</td>\n",
              "      <td>2</td>\n",
              "      <td>[[[0.7254902, 0.49803922, 0.5372549], [0.74117...</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0a157e2e-04f2-4e2f-be61-0542c65c4ed2')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-0a157e2e-04f2-4e2f-be61-0542c65c4ed2 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-0a157e2e-04f2-4e2f-be61-0542c65c4ed2');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-5d4a5703-c581-49e2-bf29-bea0519270c5\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-5d4a5703-c581-49e2-bf29-bea0519270c5')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-5d4a5703-c581-49e2-bf29-bea0519270c5 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 150
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data['localization'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "YoQ-LAZoW8w9",
        "outputId": "ab113ca4-e2d1-44cb-e72b-1075254cdc1b"
      },
      "execution_count": 109,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['abdomen', 'upper extremity', 'unknown', 'back', 'lower extremity',\n",
              "       'trunk', 'face', 'genital', 'acral'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 109
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data.isnull().sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "mtNomQ8AW8zh",
        "outputId": "790e9a35-540f-4800-ec25-22e31af76999"
      },
      "execution_count": 110,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "image_id        0\n",
              "age             0\n",
              "localization    0\n",
              "dx              0\n",
              "sex             0\n",
              "dx_type         0\n",
              "lesion_id       0\n",
              "dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 110
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "new_data"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "vgB-rvPTW81p",
        "outputId": "7fe63073-a530-4119-efb4-1b852d2e87cf"
      },
      "execution_count": 111,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "          image_id   age     localization                    dx     sex  \\\n",
              "0     ISIC_0079358  35.0          abdomen                 nevus  female   \n",
              "1     ISIC_0086914  55.0  upper extremity  basal cell carcinoma    male   \n",
              "2     ISIC_0088904  50.0          unknown  basal cell carcinoma  female   \n",
              "3     ISIC_0094098  65.0             back              melanoma    male   \n",
              "4     ISIC_0095134  70.0          abdomen              melanoma  female   \n",
              "...            ...   ...              ...                   ...     ...   \n",
              "1611  ISIC_9989778  40.0          unknown                 nevus    male   \n",
              "1612  ISIC_9995847  75.0  upper extremity       vascular lesion  female   \n",
              "1613  ISIC_9997367  70.0             face     actinic keratosis  female   \n",
              "1614  ISIC_9998679  65.0             face  basal cell carcinoma  female   \n",
              "1615  ISIC_9999251  65.0  lower extremity     actinic keratosis  female   \n",
              "\n",
              "     dx_type   lesion_id  \n",
              "0      histo  IL_3989348  \n",
              "1      histo  IL_9767756  \n",
              "2      histo  IL_8711401  \n",
              "3      histo  IL_6961144  \n",
              "4      histo  IL_4530268  \n",
              "...      ...         ...  \n",
              "1611   histo  IL_8944708  \n",
              "1612   histo  IL_1047690  \n",
              "1613   histo  IL_1956821  \n",
              "1614   histo  IL_3341905  \n",
              "1615   histo  IL_1343671  \n",
              "\n",
              "[1616 rows x 7 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-fa9957d5-2695-4fb8-89cd-06434814bec8\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>image_id</th>\n",
              "      <th>age</th>\n",
              "      <th>localization</th>\n",
              "      <th>dx</th>\n",
              "      <th>sex</th>\n",
              "      <th>dx_type</th>\n",
              "      <th>lesion_id</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>ISIC_0079358</td>\n",
              "      <td>35.0</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>nevus</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3989348</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>ISIC_0086914</td>\n",
              "      <td>55.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_9767756</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>ISIC_0088904</td>\n",
              "      <td>50.0</td>\n",
              "      <td>unknown</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8711401</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>ISIC_0094098</td>\n",
              "      <td>65.0</td>\n",
              "      <td>back</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_6961144</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>ISIC_0095134</td>\n",
              "      <td>70.0</td>\n",
              "      <td>abdomen</td>\n",
              "      <td>melanoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_4530268</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1611</th>\n",
              "      <td>ISIC_9989778</td>\n",
              "      <td>40.0</td>\n",
              "      <td>unknown</td>\n",
              "      <td>nevus</td>\n",
              "      <td>male</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_8944708</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1612</th>\n",
              "      <td>ISIC_9995847</td>\n",
              "      <td>75.0</td>\n",
              "      <td>upper extremity</td>\n",
              "      <td>vascular lesion</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1047690</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1613</th>\n",
              "      <td>ISIC_9997367</td>\n",
              "      <td>70.0</td>\n",
              "      <td>face</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1956821</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1614</th>\n",
              "      <td>ISIC_9998679</td>\n",
              "      <td>65.0</td>\n",
              "      <td>face</td>\n",
              "      <td>basal cell carcinoma</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_3341905</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1615</th>\n",
              "      <td>ISIC_9999251</td>\n",
              "      <td>65.0</td>\n",
              "      <td>lower extremity</td>\n",
              "      <td>actinic keratosis</td>\n",
              "      <td>female</td>\n",
              "      <td>histo</td>\n",
              "      <td>IL_1343671</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1616 rows × 7 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fa9957d5-2695-4fb8-89cd-06434814bec8')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-fa9957d5-2695-4fb8-89cd-06434814bec8 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-fa9957d5-2695-4fb8-89cd-06434814bec8');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-9dd25011-4417-498c-b01b-8e3193e228a6\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-9dd25011-4417-498c-b01b-8e3193e228a6')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-9dd25011-4417-498c-b01b-8e3193e228a6 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_184c0ef4-5822-4778-bbbc-d1584a9bb3fb\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('new_data')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_184c0ef4-5822-4778-bbbc-d1584a9bb3fb button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('new_data');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 111
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "##change dx to the same dx to meta data :\n",
        "new_data['dx'].unique()\n",
        "\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "pWO4iOALapbk",
        "outputId": "b91c1d25-96a6-4803-c0c4-9488ec955129"
      },
      "execution_count": 112,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['nevus', 'basal cell carcinoma', 'melanoma', 'vascular lesion',\n",
              "       'seborrheic keratosis', 'actinic keratosis',\n",
              "       'squamous cell carcinoma', 'dermatofibroma', 'solar lentigo',\n",
              "       'lichenoid keratosis'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 112
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "meta['dx'].unique()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nm7cGiL9azvt",
        "outputId": "3af5a71e-0301-45eb-b1d1-a437108a14f1"
      },
      "execution_count": 113,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array(['bkl', 'nv', 'df', 'mel', 'vasc', 'bcc', 'akiec'], dtype=object)"
            ]
          },
          "metadata": {},
          "execution_count": 113
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "dx mapping proposal:\n",
        "\n",
        "nevus → nv (Nevus)\n",
        "\n",
        "basal cell carcinoma → bcc (Basal Cell Carcinoma)\n",
        "\n",
        "melanoma → mel (Melanoma)\n",
        "\n",
        "vascular lesion → vasc (Vascular lesions)\n",
        "\n",
        "seborrheic keratosis → bkl (Benign keratosis-like lesions, which include seborrheic keratosis)\n",
        "\n",
        "actinic keratosis → akiec (Actinic Keratoses and Intraepi\n",
        "\n",
        "dermatofibroma → df (Dermatofibroma)\n"
      ],
      "metadata": {
        "id": "DCHlaiHfbgBz"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "\n",
        "\n",
        "# Mapping dictionary\n",
        "mapping = {\n",
        "    'nevus': 'nv',\n",
        "    'basal cell carcinoma': 'bcc',\n",
        "    'melanoma': 'mel',\n",
        "    'vascular lesion': 'vasc',\n",
        "    'seborrheic keratosis': 'bkl',\n",
        "    'actinic keratosis': 'akiec',\n",
        "    'dermatofibroma': 'df'\n",
        "}\n",
        "\n",
        "# Apply the mapping\n",
        "new_data['dx'] = new_data['dx'].map(mapping)\n"
      ],
      "metadata": {
        "id": "FaJRIrDYbfBw"
      },
      "execution_count": 114,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## MAP images path to this new_data df.\n",
        "base_skin_dir = '/content/drive/My Drive/ISIC-images/'\n"
      ],
      "metadata": {
        "id": "L1VCMYiTdCAc"
      },
      "execution_count": 116,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "import os\n",
        "import glob\n",
        "\n",
        "# Set the base directory to the path of the folder containing the images\n",
        "\n",
        "# Create a dictionary mapping image IDs to their file paths\n",
        "imageid_path_dict = {\n",
        "    os.path.splitext(os.path.basename(x))[0]: x\n",
        "    for x in glob.glob(os.path.join(base_skin_dir, '*.JPG'))  # Adjusted to '*.JPG' to match the file extension\n",
        "}\n",
        "\n",
        "# Assuming new_data is your DataFrame and it has a column 'image_id'\n",
        "# Make sure the image_id is in the correct case to match the filenames\n",
        "new_data['image_id'] = new_data['image_id'].str.upper()  # Convert to upper case to match the filenames\n",
        "\n",
        "# Map the image paths to your DataFrame\n",
        "new_data['path'] = new_data['image_id'].map(imageid_path_dict.get)\n"
      ],
      "metadata": {
        "id": "WiwRZq9fdCCw"
      },
      "execution_count": 117,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tqdm import tqdm\n",
        "import numpy as np\n",
        "from PIL import Image\n",
        "\n",
        "image_paths = list(new_data['path'])\n",
        "new_data['image'] = [np.asarray(Image.open(path).resize((100, 75)), dtype=np.float32) / 255.0 for path in tqdm(image_paths)]\n",
        "\n",
        "\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "arLxj7pUdCFH",
        "outputId": "c81ad326-c08a-4f26-afb9-75bc9c9153c2"
      },
      "execution_count": 118,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 1616/1616 [02:03<00:00, 13.06it/s]\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "## encode dx\n",
        "\n",
        "#Lesion Dictionary categorical codes\n",
        "lesion_code_dict = {\n",
        "    'nv': 0,\n",
        "    'mel': 1,\n",
        "    'bkl': 2,\n",
        "    'bcc': 3,\n",
        "    'akiec': 4,\n",
        "    'vasc': 5,\n",
        "    'df': 6}\n",
        "\n",
        "new_data['dx_code'] = new_data['dx'].map(lesion_code_dict.get)\n"
      ],
      "metadata": {
        "id": "68KkVAZnlnED"
      },
      "execution_count": 119,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "new_data = new_data.dropna(subset=['dx_code'])\n"
      ],
      "metadata": {
        "id": "QVbdi66n3Sw0"
      },
      "execution_count": 129,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Meta data vs New_Data"
      ],
      "metadata": {
        "id": "I4vi877f5LNI"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "### TODO: So the input data here does not match input categorical data (,20) --> check encoded_test\n",
        "### Here, I just copy code from up there so you can change it.\n",
        "from sklearn.preprocessing import StandardScaler\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "from keras.utils import to_categorical\n",
        "\n",
        "\n",
        "# Assuming you have the images and labels\n",
        "X_test_image = new_data['image']\n",
        "y_test = to_categorical(new_data['dx_code'])\n",
        "\n",
        "# Convert Pandas Series to NumPy arrays\n",
        "X_test_image = np.array(X_test_image.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 75, width = 100, channel = 3)\n",
        "X_test_image = X_test_image.reshape(X_test_image.shape[0], 75, 100, 3)\n",
        "\n",
        "# Categorical data for test\n",
        "categorical_data_test = new_data[['age', 'dx_type', \"localization\"]].copy()\n",
        "\n",
        "# Define the columns you want to scale\n",
        "columns_to_scale = ['age']\n",
        "\n",
        "# Create a StandardScaler object\n",
        "scaler = StandardScaler()\n",
        "\n",
        "# Fit and transform the 'age' column for testing data\n",
        "# First, fit the scaler on your training data or the complete dataset\n",
        "# For demonstration, assuming 'age' column from new_data is used for fitting\n",
        "scaler.fit(new_data[['age']])\n",
        "\n",
        "# Now, transform the 'age' column for testing data\n",
        "categorical_data_test['age'] = scaler.transform(categorical_data_test[['age']])\n",
        "\n",
        "# List of columns to one-hot encode\n",
        "columns_to_encode = ['dx_type', 'localization']\n",
        "\n",
        "# Perform one-hot encoding using get_dummies\n",
        "encoded_test = pd.get_dummies(categorical_data_test, columns=columns_to_encode)\n",
        "\n",
        "\n",
        "\n"
      ],
      "metadata": {
        "id": "M9th8Q5ck6XG"
      },
      "execution_count": 130,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "encoded_test.shape"
      ],
      "metadata": {
        "id": "bpVhSq8kqvtG"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Number of columns to add\n",
        "columns_to_add = 20 - encoded_test.shape[1]\n",
        "\n",
        "# Add dummy columns filled with zeros\n",
        "for i in range(columns_to_add):\n",
        "    encoded_test[f'dummy_{i}'] = 0\n"
      ],
      "metadata": {
        "id": "-77vetoy6n8w"
      },
      "execution_count": 131,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "encoded_test"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 461
        },
        "id": "tSS0nrGJ9zBY",
        "outputId": "4aebf82d-67ab-4cfd-ee77-9c51c1476df6"
      },
      "execution_count": 151,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           age  dx_type_consensus  dx_type_histo  localization_abdomen  \\\n",
              "0    -1.229638                  0              1                     1   \n",
              "1    -0.154833                  0              1                     0   \n",
              "2    -0.423534                  0              1                     0   \n",
              "3     0.382570                  0              1                     0   \n",
              "4     0.651271                  0              1                     1   \n",
              "...        ...                ...            ...                   ...   \n",
              "1611 -0.960937                  0              1                     0   \n",
              "1612  0.919972                  0              1                     0   \n",
              "1613  0.651271                  0              1                     0   \n",
              "1614  0.382570                  0              1                     0   \n",
              "1615  0.382570                  0              1                     0   \n",
              "\n",
              "      localization_acral  localization_back  localization_face  \\\n",
              "0                      0                  0                  0   \n",
              "1                      0                  0                  0   \n",
              "2                      0                  0                  0   \n",
              "3                      0                  1                  0   \n",
              "4                      0                  0                  0   \n",
              "...                  ...                ...                ...   \n",
              "1611                   0                  0                  0   \n",
              "1612                   0                  0                  0   \n",
              "1613                   0                  0                  1   \n",
              "1614                   0                  0                  1   \n",
              "1615                   0                  0                  0   \n",
              "\n",
              "      localization_genital  localization_lower extremity  localization_trunk  \\\n",
              "0                        0                             0                   0   \n",
              "1                        0                             0                   0   \n",
              "2                        0                             0                   0   \n",
              "3                        0                             0                   0   \n",
              "4                        0                             0                   0   \n",
              "...                    ...                           ...                 ...   \n",
              "1611                     0                             0                   0   \n",
              "1612                     0                             0                   0   \n",
              "1613                     0                             0                   0   \n",
              "1614                     0                             0                   0   \n",
              "1615                     0                             1                   0   \n",
              "\n",
              "      localization_unknown  localization_upper extremity  dummy_0  dummy_1  \\\n",
              "0                        0                             0        0        0   \n",
              "1                        0                             1        0        0   \n",
              "2                        1                             0        0        0   \n",
              "3                        0                             0        0        0   \n",
              "4                        0                             0        0        0   \n",
              "...                    ...                           ...      ...      ...   \n",
              "1611                     1                             0        0        0   \n",
              "1612                     0                             1        0        0   \n",
              "1613                     0                             0        0        0   \n",
              "1614                     0                             0        0        0   \n",
              "1615                     0                             0        0        0   \n",
              "\n",
              "      dummy_2  dummy_3  dummy_4  dummy_5  dummy_6  dummy_7  \n",
              "0           0        0        0        0        0        0  \n",
              "1           0        0        0        0        0        0  \n",
              "2           0        0        0        0        0        0  \n",
              "3           0        0        0        0        0        0  \n",
              "4           0        0        0        0        0        0  \n",
              "...       ...      ...      ...      ...      ...      ...  \n",
              "1611        0        0        0        0        0        0  \n",
              "1612        0        0        0        0        0        0  \n",
              "1613        0        0        0        0        0        0  \n",
              "1614        0        0        0        0        0        0  \n",
              "1615        0        0        0        0        0        0  \n",
              "\n",
              "[1438 rows x 20 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-04172fd3-6445-4b5d-8d08-e85791d11476\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>age</th>\n",
              "      <th>dx_type_consensus</th>\n",
              "      <th>dx_type_histo</th>\n",
              "      <th>localization_abdomen</th>\n",
              "      <th>localization_acral</th>\n",
              "      <th>localization_back</th>\n",
              "      <th>localization_face</th>\n",
              "      <th>localization_genital</th>\n",
              "      <th>localization_lower extremity</th>\n",
              "      <th>localization_trunk</th>\n",
              "      <th>localization_unknown</th>\n",
              "      <th>localization_upper extremity</th>\n",
              "      <th>dummy_0</th>\n",
              "      <th>dummy_1</th>\n",
              "      <th>dummy_2</th>\n",
              "      <th>dummy_3</th>\n",
              "      <th>dummy_4</th>\n",
              "      <th>dummy_5</th>\n",
              "      <th>dummy_6</th>\n",
              "      <th>dummy_7</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>-1.229638</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>-0.154833</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>-0.423534</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0.382570</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0.651271</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1611</th>\n",
              "      <td>-0.960937</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1612</th>\n",
              "      <td>0.919972</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1613</th>\n",
              "      <td>0.651271</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1614</th>\n",
              "      <td>0.382570</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1615</th>\n",
              "      <td>0.382570</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>1438 rows × 20 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-04172fd3-6445-4b5d-8d08-e85791d11476')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-04172fd3-6445-4b5d-8d08-e85791d11476 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-04172fd3-6445-4b5d-8d08-e85791d11476');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-4ca2b41c-a38e-450c-8200-a89873502ae1\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-4ca2b41c-a38e-450c-8200-a89873502ae1')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-4ca2b41c-a38e-450c-8200-a89873502ae1 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_000cb0c8-4319-4ce2-917b-ef363962e0b9\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('encoded_test')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_000cb0c8-4319-4ce2-917b-ef363962e0b9 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('encoded_test');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 151
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "encoded_test.shape"
      ],
      "metadata": {
        "id": "MJzeWCHq1ulM"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "X_test_image.shape"
      ],
      "metadata": {
        "id": "Tj5m2oMM109n"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "y_test.shape"
      ],
      "metadata": {
        "id": "oLQACbsG19FU"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "Y_pred_classes.shape --"
      ],
      "metadata": {
        "id": "CufcT6VI1_LK"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "### TODO: Predict with Dense\n",
        "\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "import plotly.graph_objs as go\n",
        "classes = range(7)\n",
        "\n",
        "Y_pred = model_dense.predict([X_test_image, encoded_test])\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "SXd_1gtzdCHO",
        "outputId": "82596e9e-68f5-4d2d-bd0b-50317494b3a0"
      },
      "execution_count": 133,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "45/45 [==============================] - 2s 47ms/step\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(y_test, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(y_test, Y_pred_classes)\n",
        "print(f\"Classification Report for <<DenseNet201>> with Multi_modal: \")\n",
        "print(report)\n"
      ],
      "metadata": {
        "id": "pxi9tosi3_iJ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "import numpy as np\n",
        "import plotly.figure_factory as ff\n",
        "\n",
        "classes = range(7)  # Replace 7 with the actual number of classes\n",
        "\n",
        "# Calculate the confusion matrix\n",
        "cm = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plotting Confusion Matrix\n",
        "fig = ff.create_annotated_heatmap(cm, x=list(classes), y=list(classes), colorscale='Blues')\n",
        "fig.update_layout(title='Confusion Matrix', xaxis_title='Predicted Label', yaxis_title='True Label')\n",
        "\n",
        "# Display the figure (use fig.show() in your local environment)\n",
        "fig.show()\n",
        "\n",
        "# Display Classification Report\n",
        "print(classification_report(Y_true, Y_pred_classes))\n"
      ],
      "metadata": {
        "id": "uH7XLq6cdCMM",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 785
        },
        "outputId": "dfceba9f-90bb-4c55-98d3-273f4851aad4"
      },
      "execution_count": 148,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.24.1.min.js\"></script>                <div id=\"661b9b5d-fb27-4c5b-b79f-afb96d2f2b20\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"661b9b5d-fb27-4c5b-b79f-afb96d2f2b20\")) {                    Plotly.newPlot(                        \"661b9b5d-fb27-4c5b-b79f-afb96d2f2b20\",                        [{\"colorscale\":[[0.0,\"rgb(247,251,255)\"],[0.125,\"rgb(222,235,247)\"],[0.25,\"rgb(198,219,239)\"],[0.375,\"rgb(158,202,225)\"],[0.5,\"rgb(107,174,214)\"],[0.625,\"rgb(66,146,198)\"],[0.75,\"rgb(33,113,181)\"],[0.875,\"rgb(8,81,156)\"],[1.0,\"rgb(8,48,107)\"]],\"reversescale\":false,\"showscale\":false,\"x\":[0,1,2,3,4,5,6],\"y\":[0,1,2,3,4,5,6],\"z\":[[565,2,31,0,0,0,4],[133,16,55,0,0,13,36],[43,1,21,0,0,0,3],[101,3,104,15,4,14,99],[15,0,26,0,0,3,19],[30,0,7,1,0,6,7],[51,0,6,1,0,0,3]],\"type\":\"heatmap\"}],                        {\"annotations\":[{\"font\":{\"color\":\"#FFFFFF\"},\"showarrow\":false,\"text\":\"565\",\"x\":0,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"2\",\"x\":1,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"31\",\"x\":2,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":3,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"4\",\"x\":6,\"xref\":\"x\",\"y\":0,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"133\",\"x\":0,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"16\",\"x\":1,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"55\",\"x\":2,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":3,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"13\",\"x\":5,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"36\",\"x\":6,\"xref\":\"x\",\"y\":1,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"43\",\"x\":0,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"1\",\"x\":1,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"21\",\"x\":2,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":3,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"3\",\"x\":6,\"xref\":\"x\",\"y\":2,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"101\",\"x\":0,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"3\",\"x\":1,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"104\",\"x\":2,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"15\",\"x\":3,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"4\",\"x\":4,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"14\",\"x\":5,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"99\",\"x\":6,\"xref\":\"x\",\"y\":3,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"15\",\"x\":0,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":1,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"26\",\"x\":2,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":3,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"3\",\"x\":5,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"19\",\"x\":6,\"xref\":\"x\",\"y\":4,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"30\",\"x\":0,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":1,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"7\",\"x\":2,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"1\",\"x\":3,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"6\",\"x\":5,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"7\",\"x\":6,\"xref\":\"x\",\"y\":5,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"51\",\"x\":0,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":1,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"6\",\"x\":2,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"1\",\"x\":3,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":4,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"0\",\"x\":5,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"},{\"font\":{\"color\":\"#000000\"},\"showarrow\":false,\"text\":\"3\",\"x\":6,\"xref\":\"x\",\"y\":6,\"yref\":\"y\"}],\"xaxis\":{\"dtick\":1,\"gridcolor\":\"rgb(0, 0, 0)\",\"side\":\"top\",\"ticks\":\"\",\"title\":{\"text\":\"Predicted Label\"}},\"yaxis\":{\"dtick\":1,\"ticks\":\"\",\"ticksuffix\":\"  \",\"title\":{\"text\":\"True Label\"}},\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"title\":{\"text\":\"Confusion Matrix\"}},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('661b9b5d-fb27-4c5b-b79f-afb96d2f2b20');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "              precision    recall  f1-score   support\n",
            "\n",
            "           0       0.60      0.94      0.73       602\n",
            "           1       0.73      0.06      0.12       253\n",
            "           2       0.08      0.31      0.13        68\n",
            "           3       0.88      0.04      0.08       340\n",
            "           4       0.00      0.00      0.00        63\n",
            "           5       0.17      0.12      0.14        51\n",
            "           6       0.02      0.05      0.03        61\n",
            "\n",
            "    accuracy                           0.44      1438\n",
            "   macro avg       0.35      0.22      0.18      1438\n",
            "weighted avg       0.60      0.44      0.36      1438\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###Below is Milestone 2 and Milestone 1"
      ],
      "metadata": {
        "id": "WZhYh1QC_IG6"
      },
      "execution_count": 1,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "zgOGMmDjIXb3"
      },
      "source": [
        "## Handling Null/Missing Values"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Vx66Irx4INE3"
      },
      "outputs": [],
      "source": [
        "#Inspecting null values\n",
        "df.isnull().sum()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "6HArk9plIQ2W"
      },
      "source": [
        "As we can see there are 57 null values in the age column so we will use mean imputation to replace these null values."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "g4G46MdIIepJ"
      },
      "outputs": [],
      "source": [
        "#Mean imputation of null values in age column\n",
        "df['age'].fillna(int(df['age'].mean()),inplace=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "9-XGKTaRIm2X"
      },
      "outputs": [],
      "source": [
        "#Now number of nulls is 0 in each column\n",
        "df.isnull().sum()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "DNXHiggmIrPM"
      },
      "outputs": [],
      "source": [
        "df[\"age\"].value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "i1cpE3yVRYfI"
      },
      "outputs": [],
      "source": [
        "df['dx'].value_counts()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1DbOjx6eQ49T"
      },
      "source": [
        "There is a age with value 0 and sex with value 'unknown', therefore, we are only keeping rows where age != 0 and sex != unknown"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "C03_A-bIRkO9"
      },
      "outputs": [],
      "source": [
        "#Subsetting the data to only keep age != 0 and sex != unknown\n",
        "df_clean= df[df['age'] != 0]\n",
        "df_clean= df_clean[df_clean['sex'] != 'unknown']"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "21LF34q7R6tH"
      },
      "outputs": [],
      "source": [
        "df_clean[\"dx\"].value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_clean['dx_code'] = pd.Categorical(df_clean['dx']).codes"
      ],
      "metadata": {
        "id": "xbfd_JoAWsEF"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "glbt3wf1WsGa"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "lJ1gz-E2SGIx"
      },
      "source": [
        "As we can see, there is a reduction in number of observations for nv, bkl, and vasc. However, the reduction for the minority class, vasc is not a lot (only 4) and for the class with the highest samples, nv is the most, and class with the 3rd highest samples nv is the second most, we believe it is fine to proceed with a subset of the data."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [],
      "metadata": {
        "id": "ms9Lkj9jWqSS"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "MEUG8cKuOM24"
      },
      "source": [
        "## Resizing the images"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "lH6OLNXmKy4E"
      },
      "outputs": [],
      "source": [
        "#Lesion dictionary\n",
        "lesion_type_dict = {\n",
        "    'nv': 'Melanocytic nevi',\n",
        "    'mel': 'Melanoma',\n",
        "    'bkl': 'Benign keratosis-like lesions ',\n",
        "    'bcc': 'Basal cell carcinoma',\n",
        "    'akiec': 'Actinic keratoses',\n",
        "    'vasc': 'Vascular lesions',\n",
        "    'df': 'Dermatofibroma'\n",
        "}\n",
        "\n",
        "#Lesion Dictionary categorical codes\n",
        "lesion_code_dict = {\n",
        "    'nv': 0,\n",
        "    'mel': 1,\n",
        "    'bkl': 2,\n",
        "    'bcc': 3,\n",
        "    'akiec': 4,\n",
        "    'vasc': 5,\n",
        "    'df': 6}\n",
        "import glob\n",
        "\n",
        "\n",
        "#Base dictionary\n",
        "base_skin_dir = '/content/'\n",
        "\n",
        "# Assuming you have two folders named 'HAM10000_images_part_1' and 'HAM10000_images_part_2'\n",
        "folders = ['HAM10000_images_part_1', 'HAM10000_images_part_2']\n",
        "\n",
        "# Merge images from both folders into one dictionary and find the images based on the image_id\n",
        "imageid_path_dict = {\n",
        "    os.path.splitext(os.path.basename(x))[0]: x\n",
        "    for folder in folders\n",
        "    for x in glob.glob(os.path.join(base_skin_dir, folder, '*.jpg'))\n",
        "}"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "6f7tvHXsMRfx"
      },
      "outputs": [],
      "source": [
        "#map image_id to the dictionary and store it in a new path column\n",
        "df_clean['path'] = df_clean['image_id'].map(imageid_path_dict.get)\n",
        "\n",
        "#Store the full form of a lesion in a new column, cell type\n",
        "df_clean['cell_type'] = df_clean['dx'].map(lesion_type_dict.get)\n",
        "\n",
        "#Categorically encode the different lesion types (0-6)\n",
        "df_clean['cell_type_idx'] = df_clean['dx'].map(lesion_code_dict.get)\n",
        "\n",
        "df_clean.head()"
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "8nQ6OrBVhKhA"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "12lYl5weUgNB"
      },
      "outputs": [],
      "source": [
        "#Resizing the images to 100x125 and normalizing the pixel values to between 0-1\n",
        "df_clean['image'] = df_clean['path'].map(lambda x: np.asarray(Image.open(x).resize((100,75))))\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "bwkZjrbIldxY"
      },
      "source": [
        "## Fixing Data Imbalance"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Wimqc0u_Z32s"
      },
      "source": [
        "From the distribution above, we can see that the dataset is highly imbalanced. Did not use random oversampling because then then there will be multiple duplicates of the minority class images, which may cause our model to overfit."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "tOoAhlyva2VG"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "import tensorflow as tf\n",
        "from sklearn.preprocessing import StandardScaler\n",
        "from imblearn.over_sampling import SMOTE\n",
        "from collections import Counter"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Code continuation"
      ],
      "metadata": {
        "id": "OM9M9R2SSwBh"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X = df_clean['image']\n",
        "y = to_categorical(df_clean['dx_code'])"
      ],
      "metadata": {
        "id": "ed87gG9JSwPj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "# Split the data into training and testing sets\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=42)"
      ],
      "metadata": {
        "id": "VRyNooWBW8pj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train = np.array(X_train.tolist())\n",
        "X_test = np.array(X_test.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 75, width = 100, channel = 3)\n",
        "X_train = X_train.reshape(X_train.shape[0], 75, 100, 3)\n",
        "X_test = X_test.reshape(X_test.shape[0], 75, 100, 3)"
      ],
      "metadata": {
        "id": "btY6OPynW8sJ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Function to plot the confusion matrix with Plotly\n",
        "def plot_confusion_matrix(cm, classes, normalize=False):\n",
        "    if normalize:\n",
        "        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n",
        "        colorscale = 'Plasma'\n",
        "    else:\n",
        "        colorscale = 'Magma_r'  # Reversed 'Magma' colorscale for non-normalized matrix\n",
        "\n",
        "    annotations = []\n",
        "    for i in range(len(classes)):\n",
        "        for j in range(len(classes)):\n",
        "            annotations.append(\n",
        "                {\n",
        "                    'x': classes[j],\n",
        "                    'y': classes[i],\n",
        "                    'text': str(cm[i, j]),\n",
        "                    'showarrow': False,\n",
        "                    'font': {'color': 'red' if cm[i, j] > 0.5 else 'black'}\n",
        "                }\n",
        "            )\n",
        "\n",
        "    fig = go.Figure(data=go.Heatmap(\n",
        "        z=cm,\n",
        "        x=list(classes),\n",
        "        y=list(classes),\n",
        "        colorscale=colorscale,\n",
        "        colorbar=dict(title='Normalized' if normalize else 'Count'),\n",
        "        showscale=True,\n",
        "        hoverinfo='z'\n",
        "    ))\n",
        "\n",
        "    fig.update_layout(\n",
        "        title='Confusion Matrix',\n",
        "        xaxis=dict(title='Predicted label'),\n",
        "        yaxis=dict(title='True label'),\n",
        "        annotations=annotations\n",
        "    )\n",
        "\n",
        "    if normalize:\n",
        "        fig.update_layout(title_text='Normalized Confusion Matrix')\n",
        "    else:\n",
        "        fig.update_layout(title_text='Confusion Matrix (Counts)')\n",
        "\n",
        "    fig.show()"
      ],
      "metadata": {
        "id": "-k0XXFZxW8yY"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_acc',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)"
      ],
      "metadata": {
        "id": "8nBLstKmW80c"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "split_proportion = 0.8\n",
        "\n",
        "# Randomly shuffle the rows of the DataFrame\n",
        "shuffled_data = df_clean.sample(frac=1, random_state=41)  # random_state for reproducibility\n",
        "\n",
        "# Calculate the number of rows for the first piece\n",
        "total_rows = shuffled_data.shape[0]\n",
        "split_size = int(total_rows * split_proportion)\n",
        "\n",
        "# Split the DataFrame into two pieces\n",
        "Train = shuffled_data.iloc[:split_size]\n",
        "Test = shuffled_data.iloc[split_size:]"
      ],
      "metadata": {
        "id": "yC_Y12wgW83E"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X_train_image = Train['image']\n",
        "y_train = to_categorical(Train['dx_code'])\n",
        "\n",
        "X_test_image = Test['image']\n",
        "y_test = to_categorical(Test['dx_code'])"
      ],
      "metadata": {
        "id": "WetivTSCXNo8"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train_image = np.array(X_train_image.tolist())\n",
        "X_test_image = np.array(X_test_image.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 75, width = 100, channel = 3)\n",
        "X_train_image = X_train_image.reshape(X_train_image.shape[0], 75, 100, 3)\n",
        "X_test_image = X_test_image.reshape(X_test_image.shape[0], 75, 100, 3)"
      ],
      "metadata": {
        "id": "di36g5TrXNrs"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "categorical_data_train = Train[[ 'age' ,'dx_type' ,\"localization\" ]]\n",
        "categorical_data_test = Test[[ 'age' ,'dx_type' ,\"localization\" ]]\n",
        "\n",
        "# Define the columns you want to scale\n",
        "columns_to_scale = ['age']\n",
        "\n",
        "# Create a StandardScaler object\n",
        "scaler = StandardScaler()\n",
        "\n",
        "# Reshape the column to a 2D array before fitting the scaler\n",
        "categorical_data_train[columns_to_scale] = scaler.fit_transform(categorical_data_train[columns_to_scale].values.reshape(-1, 1))\n",
        "categorical_data_test[columns_to_scale] = scaler.transform(categorical_data_test[columns_to_scale].values.reshape(-1, 1))"
      ],
      "metadata": {
        "id": "0O--5-w9XNuO"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "# List of columns to one-hot encode\n",
        "columns_to_encode = ['dx_type', 'localization']\n",
        "\n",
        "# Perform one-hot encoding using get_dummies\n",
        "encoded_train = pd.get_dummies(categorical_data_train, columns=columns_to_encode)\n",
        "encoded_test = pd.get_dummies(categorical_data_test, columns=columns_to_encode)"
      ],
      "metadata": {
        "id": "Y9On3xDAXNw5"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Input, Concatenate\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "\n",
        "categorical_input = Input(shape=(20,))\n",
        "\n",
        "\n",
        "# Load the pre-trained DenseNet-121 model (Same as before)\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# After GlobalAveragePooling2D layer, concatenate with the categorical input\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\n",
        "\n",
        "# Add Custom Layers for Categorical Data\n",
        "y = Dense(64, activation='relu')(categorical_input)\n",
        "x = Concatenate()([x, y])\n",
        "\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model with both image and categorical inputs\n",
        "model_dense = Model(inputs=[base_model.input, categorical_input], outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,\n",
        "    decay_rate=0.9\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)"
      ],
      "metadata": {
        "id": "PuiZyUDiW85K"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "encoded_train.shape"
      ],
      "metadata": {
        "id": "MwEYTEIeaEFw"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"Shape of image training data (X_train_image):\", X_train_image.shape)\n",
        "print(\"Shape of categorical training data (encoded_train):\", encoded_train.shape)\n"
      ],
      "metadata": {
        "id": "VX3Iu51tbhVZ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## DEBUG :\n",
        "# Take one sample from both image and categorical data\n",
        "sample_image_data = X_train_image[:1]\n",
        "sample_categorical_data = encoded_train[:1]\n",
        "\n",
        "# Pass the sample through the model\n",
        "try:\n",
        "    sample_prediction = model_dense.predict([sample_image_data, sample_categorical_data])\n",
        "\n",
        "    print(\"Sample prediction successful. Output shape:\", sample_prediction.shape)\n",
        "except Exception as e:\n",
        "    print(\"Error during sample prediction:\", e)\n"
      ],
      "metadata": {
        "id": "dSCzybj4bkvZ"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "h3RtWr6jd84e"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Train the model with data augmentation and callbacks\n",
        "epochs = 20\n",
        "batch_size = 10\n",
        "history = model_dense.fit(\n",
        "    [X_train_image, encoded_train],  # Update with your actual image and categorical training data\n",
        "    y_train, epochs=epochs, batch_size=batch_size,\n",
        "    callbacks=[learning_rate_reduction , early_stopping], validation_data=([X_test_image, encoded_test], y_test)\n",
        ")\n",
        "\n",
        "# Plot the training and validation loss\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()"
      ],
      "metadata": {
        "id": "uwhWLSUuW87h"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ],
      "metadata": {
        "id": "qb8cn41uXelH"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "--"
      ],
      "metadata": {
        "id": "AYr_UTUPW894"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Defining Method\n"
      ],
      "metadata": {
        "id": "aIYDlFVuRHDi"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Function to plot the confusion matrix with Plotly\n",
        "def plot_confusion_matrix(cm, classes, normalize=False):\n",
        "    if normalize:\n",
        "        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n",
        "        colorscale = 'Plasma'\n",
        "    else:\n",
        "        colorscale = 'Magma_r'  # Reversed 'Magma' colorscale for non-normalized matrix\n",
        "\n",
        "    annotations = []\n",
        "    for i in range(len(classes)):\n",
        "        for j in range(len(classes)):\n",
        "            annotations.append(\n",
        "                {\n",
        "                    'x': classes[j],\n",
        "                    'y': classes[i],\n",
        "                    'text': str(cm[i, j]),\n",
        "                    'showarrow': False,\n",
        "                    'font': {'color': 'red' if cm[i, j] > 0.5 else 'black'}\n",
        "                }\n",
        "            )\n",
        "\n",
        "    fig = go.Figure(data=go.Heatmap(\n",
        "        z=cm,\n",
        "        x=list(classes),\n",
        "        y=list(classes),\n",
        "        colorscale=colorscale,\n",
        "        colorbar=dict(title='Normalized' if normalize else 'Count'),\n",
        "        showscale=True,\n",
        "        hoverinfo='z'\n",
        "    ))\n",
        "\n",
        "    fig.update_layout(\n",
        "        title='Confusion Matrix',\n",
        "        xaxis=dict(title='Predicted label'),\n",
        "        yaxis=dict(title='True label'),\n",
        "        annotations=annotations\n",
        "    )\n",
        "\n",
        "    if normalize:\n",
        "        fig.update_layout(title_text='Normalized Confusion Matrix')\n",
        "    else:\n",
        "        fig.update_layout(title_text='Confusion Matrix (Counts)')\n",
        "\n",
        "    fig.show()"
      ],
      "metadata": {
        "id": "w1rhChRdRKqt"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "#Adding normalization and standardization to train test split\n",
        "\n",
        "def train_test_df_normstandard(df):\n",
        "    features=df.drop(columns=['cell_type_idx'],axis=1)\n",
        "    target=df['cell_type_idx']\n",
        "\n",
        "    # Create First Train and Test sets\n",
        "    x_train_o, x_test_o, y_train_o, y_test_o = train_test_split(features, target, test_size=0.20,random_state=123)\n",
        "\n",
        "    x_train = np.asarray(x_train_o['image'].tolist())\n",
        "    x_test = np.asarray(x_test_o['image'].tolist())\n",
        "\n",
        "    #Normalization\n",
        "    x_train = x_train / 255\n",
        "    x_test = x_test / 255\n",
        "\n",
        "    #The standardization is done using the training set Mean and Std. Deviation as reference\n",
        "    x_train_mean = np.mean(x_train)\n",
        "    x_train_std = np.std(x_train)\n",
        "\n",
        "    x_train = (x_train - x_train_mean)/x_train_std\n",
        "    x_test = (x_test - x_train_mean)/x_train_std\n",
        "\n",
        "    # Perform one-hot encoding on the labels\n",
        "    y_train = to_categorical(y_train_o, num_classes = 7)\n",
        "    y_test = to_categorical(y_test_o, num_classes = 7)\n",
        "\n",
        "    #Splitting training into Train and Validatation sets\n",
        "    x_train, x_validate, y_train, y_validate = train_test_split(x_train, y_train, test_size = 0.1,random_state=123)\n",
        "\n",
        "    #Reshaping the Images into 3 channels (RGB)\n",
        "    x_train = x_train.reshape(x_train.shape[0], *(100, 125, 3))\n",
        "    x_test = x_test.reshape(x_test.shape[0], *(100, 125, 3))\n",
        "    x_validate = x_validate.reshape(x_validate.shape[0], *(100, 125, 3))\n",
        "\n",
        "    return x_train,x_validate,x_test,y_train,y_validate,y_test\n",
        "\n",
        "x_train,x_validate,x_test,y_train,y_validate,y_test = train_test_df_normstandard(df_clean)"
      ],
      "metadata": {
        "id": "s5pxRZ6HS9Aj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "len(x_train)"
      ],
      "metadata": {
        "id": "Uh8Up715Yzmd"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "czNCf1LIWfh0"
      },
      "source": [
        "# BEST MODEL"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
        "\n",
        "#Data augmentation to prevent overfitting\n",
        "datagen = ImageDataGenerator(\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.12,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.12,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=True,  # randomly flip images\n",
        "        vertical_flip=True)  # randomly flip images\n",
        "\n",
        "datagen.fit(x_train)\n",
        "'''"
      ],
      "metadata": {
        "id": "PS8ilKzxQN7T"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "len(x_train)"
      ],
      "metadata": {
        "id": "6840mv7XY1rj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qooZ7iSDWh2m"
      },
      "outputs": [],
      "source": [
        "\n",
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "p2SaJ6V0W10I"
      },
      "outputs": [],
      "source": [
        "'''\n",
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import DenseNet201\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "\n",
        "# Load the pre-trained DenseNet-201 model (weights pre-trained on ImageNet)\n",
        "base_model = DenseNet201(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95  # Choose the number of layers you want to freeze\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Redefining FC Layer since include_top is set to False\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu')(x)\n",
        "predictions = Dense(7, activation='softmax')(x) #Now predicts 7 classes\n",
        "\n",
        "# Create the final model\n",
        "model_dense = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.01\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n",
        "'''"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "76qZIH2WW4sv"
      },
      "outputs": [],
      "source": [
        "# Fit the model\n",
        "'''\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "\n",
        "history = model_dense.fit_generator(datagen.flow(x_train, y_train, batch_size=batch_size),\n",
        "                                    epochs=epochs, verbose=1, steps_per_epoch=x_train.shape[0] // batch_size,\n",
        "                                    callbacks=[learning_rate_reduction,early_stopping], validation_data=(x_validate, y_validate))\n",
        "\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n",
        "'''"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "-X2kJZCxW60b"
      },
      "outputs": [],
      "source": [
        "'''\n",
        "#Printing classification report\n",
        "import plotly.graph_objects as go\n",
        "\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_dense.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<DenseNet201>> with input normalization, data augmentation, batch normalization, and drop out: \")\n",
        "print(report)\n",
        "'''"
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "P_B-ir4ijQw7"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "RckXS9oDWiDS"
      },
      "source": [
        "# MULTI_MODAL"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "jE8szIzJWkSw"
      },
      "outputs": [],
      "source": [
        "# Define the proportion of the dataset to be used for training\n",
        "split_proportion = 0.8\n",
        "\n",
        "# Assuming 'df_clean' is a pandas DataFrame containing the dataset\n",
        "\n",
        "# Shuffle the rows of the DataFrame\n",
        "shuffled_data = df_clean.sample(frac=1, random_state=41)  # Set a random state for reproducibility\n",
        "\n",
        "# Calculate the number of rows for the training set\n",
        "total_rows = shuffled_data.shape[0]\n",
        "split_size = int(total_rows * split_proportion)\n",
        "\n",
        "# Split the data into training and testing sets\n",
        "Train = shuffled_data.iloc[:split_size]\n",
        "Test = shuffled_data.iloc[split_size:]\n"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X_train_images = Train['image']\n",
        "y_train = to_categorical(Train['dx_code'])\n",
        "\n",
        "X_test_images = Test['image']\n",
        "y_test = to_categorical(Test['dx_code'])"
      ],
      "metadata": {
        "id": "fJyQjhHlTqGe"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train_image = np.array(X_train_images.tolist())\n",
        "X_test_image = np.array(X_test_images.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 125, width = 100, channel = 3)  --> switch to 125, 100 as the code above.\n",
        "X_train_image = X_train_image.reshape(X_train_image.shape[0], 125, 100, 3)\n",
        "X_test_image = X_test_image.reshape(X_test_image.shape[0], 125, 100, 3)"
      ],
      "metadata": {
        "id": "gFFQPYJRROMn"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "## divide  / 255.0\n",
        "X_train_image =  X_train_image/ 255.0\n",
        "\n",
        "\n",
        "\n",
        "X_test_image = X_test_image /225.0"
      ],
      "metadata": {
        "id": "ncLJz2tG-6KO"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "categorical_data_train = Train[[ 'age' ,'dx_type' ,\"localization\" ]]\n",
        "categorical_data_test = Test[[ 'age' ,'dx_type' ,\"localization\" ]]\n",
        "\n",
        "# Define the columns you want to scale\n",
        "columns_to_scale = ['age']\n",
        "\n",
        "# Create a StandardScaler object\n",
        "scaler = StandardScaler()\n",
        "\n",
        "# Reshape the column to a 2D array before fitting the scaler\n",
        "categorical_data_train[columns_to_scale] = scaler.fit_transform(categorical_data_train[columns_to_scale].values.reshape(-1, 1))\n",
        "categorical_data_test[columns_to_scale] = scaler.transform(categorical_data_test[columns_to_scale].values.reshape(-1, 1))\n"
      ],
      "metadata": {
        "id": "YGykDsQ0Ttq4"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# List of columns to one-hot encode\n",
        "columns_to_encode = ['dx_type', 'localization']\n",
        "\n",
        "# Perform one-hot encoding using get_dummies\n",
        "encoded_train = pd.get_dummies(categorical_data_train, columns=columns_to_encode)\n",
        "encoded_test = pd.get_dummies(categorical_data_test, columns=columns_to_encode)"
      ],
      "metadata": {
        "id": "lsfA45WHTttt"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "how can i augment data here hmm?: Because here if I augment data in the training set, I have to set the according meta data for the images.\n",
        "\n",
        "Also for data normalization- we would have to do the same thing\n",
        "\n",
        "So here, run the baseline model first.\n",
        "\n",
        "'''"
      ],
      "metadata": {
        "id": "_-nomvi7ZE-s"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import DenseNet201\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Input, Concatenate\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "\n",
        "categorical_input = Input(shape=(20,))\n",
        "\n",
        "# Load the pre-trained DenseNet-121 model (Same as before)\n",
        "base_model = DenseNet201(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Redefining FC Layer since include_top is set to False\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu')(x)\n",
        "\n",
        "\n",
        "# Add Custom Layers for Categorical Data\n",
        "y = Dense(64, activation='relu')(categorical_input)\n",
        "x = Concatenate()([x, y])\n",
        "\n",
        "#x = BatchNormalization()(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "\n",
        "# Create the final model with both image and categorical inputs\n",
        "model_dense = Model(inputs=[base_model.input, categorical_input], outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,\n",
        "    decay_rate=0.9\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)"
      ],
      "metadata": {
        "id": "Rzh5LyCGO_g6"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "encoded_train.shape"
      ],
      "metadata": {
        "id": "DDGVAPPkxUX4"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"Shape of X_train_image:\", X_train_image.shape)\n",
        "print(\"Shape of encoded_train:\", encoded_train.shape)"
      ],
      "metadata": {
        "id": "846PUGcTxnrF"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Train the model with data augmentation and callbacks\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "history = model_dense.fit(\n",
        "    [X_train_image, encoded_train],  # Update with your actual image and categorical training data\n",
        "    y_train, epochs=epochs, batch_size=batch_size,   verbose=1,\n",
        "        callbacks=[learning_rate_reduction, early_stopping], validation_data=([X_test_image, encoded_test], y_test)\n",
        ")\n",
        "\n",
        "\n",
        "# Plot the training and validation loss\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()"
      ],
      "metadata": {
        "id": "KuANoHX0UCpj"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "Y_pred = model_dense.predict([X_test_image, encoded_test])\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<DenseNet201>> : \")\n",
        "print(report)\n"
      ],
      "metadata": {
        "id": "UuHgIekFUFKw"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Plot training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ],
      "metadata": {
        "id": "xOEA7kuCO_jO"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "nvIRuVxJO_l2"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "---"
      ],
      "metadata": {
        "id": "3EVZfCWXO-rf"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "df_clean"
      ],
      "metadata": {
        "id": "sElfXg3r4DRm"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X = df_clean['image']\n",
        "y = to_categorical(df_clean['dx_code'])"
      ],
      "metadata": {
        "id": "LefT5dVE4KKg"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "# Split the data into training and testing sets\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=42)\n",
        "\n",
        "print(X_train.shape , \"\\n\")\n",
        "print(X_train[1].shape , \"\\n\")\n"
      ],
      "metadata": {
        "id": "FHEgGl_44Dbx"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Convert Pandas Series to NumPy arrays\n",
        "X_train = np.array(X_train.tolist())\n",
        "X_test = np.array(X_test.tolist())\n",
        "\n",
        "# Reshape image data in 3 dimensions (height = 125, width = 100, channel = 3)\n",
        "X_train = X_train.reshape(X_train.shape[0], 125, 100, 3)\n",
        "X_test = X_test.reshape(X_test.shape[0], 75, 100, 3)"
      ],
      "metadata": {
        "id": "IJbn5HLQ4OfV"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
        "\n",
        "# With data augmentation to prevent overfitting\n",
        "\n",
        "datagen = ImageDataGenerator(\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.1,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.1,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=False,  # randomly flip images\n",
        "        vertical_flip=False)  # randomly flip images\n",
        "\n",
        "datagen.fit(X_train)"
      ],
      "metadata": {
        "id": "OnrbtFKu4OiA"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_acc',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)\n"
      ],
      "metadata": {
        "id": "-kqlsIui4Q2n"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "split_proportion = 0.8\n",
        "\n",
        "# Randomly shuffle the rows of the DataFrame\n",
        "shuffled_data = df_clean.sample(frac=1, random_state=41)  # random_state for reproducibility\n",
        "\n",
        "# Calculate the number of rows for the first piece\n",
        "total_rows = shuffled_data.shape[0]\n",
        "split_size = int(total_rows * split_proportion)\n",
        "\n",
        "# Split the DataFrame into two pieces\n",
        "Train = shuffled_data.iloc[:split_size]\n",
        "Test = shuffled_data.iloc[split_size:]\n"
      ],
      "metadata": {
        "id": "IjdcWSvm4Q5f"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X_train_image = Train['image']\n",
        "y_train = to_categorical(Train['dx_code'])\n",
        "\n",
        "X_test_image = Test['image']\n",
        "y_test = to_categorical(Test['dx_code'])\n"
      ],
      "metadata": {
        "id": "wHm52msy4gLY"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "X_train_image = Train['image']\n",
        "y_train = to_categorical(Train['dx_code'])\n",
        "\n",
        "X_test_image = Test['image']\n",
        "y_test = to_categorical(Test['dx_code'])\n"
      ],
      "metadata": {
        "id": "rmW7kZR04gNt"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "7ZxiPZyw4gQC"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "1HqO8f9S4gSH"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "# How to change data augmentation and normalization method:\n"
      ],
      "metadata": {
        "id": "Bg-ylxUHXs4f"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Goal :\n",
        "'''\n",
        "Data-aug only change the images and we won;t know in advanced which will be applied to which\n",
        "\n",
        "To do\n",
        "'''"
      ],
      "metadata": {
        "id": "Yl1nkplBYAXq"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
        "\n",
        "#Data augmentation to prevent overfitting\n",
        "datagen = ImageDataGenerator(\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.12,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.12,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=True,  # randomly flip images\n",
        "        vertical_flip=True)  # randomly flip images\n",
        "\n",
        "datagen.fit(x_train)"
      ],
      "metadata": {
        "id": "sH9FwAYDXyRB"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "#Adding normalization and standardization to train test split\n",
        "\n",
        "def train_test_df_normstandard(df):\n",
        "    features=df.drop(columns=['cell_type_idx'],axis=1)\n",
        "    target=df['cell_type_idx']\n",
        "\n",
        "    # Create First Train and Test sets\n",
        "    x_train_o, x_test_o, y_train_o, y_test_o = train_test_split(features, target, test_size=0.20,random_state=123)\n",
        "\n",
        "    x_train = np.asarray(x_train_o['image'].tolist())\n",
        "    x_test = np.asarray(x_test_o['image'].tolist())\n",
        "\n",
        "    #Normalization\n",
        "    x_train = x_train / 255\n",
        "    x_test = x_test / 255\n",
        "\n",
        "    #The standardization is done using the training set Mean and Std. Deviation as reference\n",
        "    x_train_mean = np.mean(x_train)\n",
        "    x_train_std = np.std(x_train)\n",
        "\n",
        "    x_train = (x_train - x_train_mean)/x_train_std\n",
        "    x_test = (x_test - x_train_mean)/x_train_std\n",
        "\n",
        "    # Perform one-hot encoding on the labels\n",
        "    y_train = to_categorical(y_train_o, num_classes = 7)\n",
        "    y_test = to_categorical(y_test_o, num_classes = 7)\n",
        "\n",
        "    #Splitting training into Train and Validatation sets\n",
        "    x_train, x_validate, y_train, y_validate = train_test_split(x_train, y_train, test_size = 0.1,random_state=123)\n",
        "\n",
        "    #Reshaping the Images into 3 channels (RGB)\n",
        "    x_train = x_train.reshape(x_train.shape[0], *(100, 125, 3))\n",
        "    x_test = x_test.reshape(x_test.shape[0], *(100, 125, 3))\n",
        "    x_validate = x_validate.reshape(x_validate.shape[0], *(100, 125, 3))\n",
        "\n",
        "    return x_train,x_validate,x_test,y_train,y_validate,y_test\n",
        "\n",
        "x_train,x_validate,x_test,y_train,y_validate,y_test = train_test_df_normstandard(df_clean)"
      ],
      "metadata": {
        "id": "xir7teQDXyTW"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "### Try with ResNet50"
      ],
      "metadata": {
        "id": "XnOQGjPoX3vQ"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "## RESNET50\n",
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Input, Concatenate\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "categorical_input = Input(shape=(20,))\n",
        "\n",
        "# Load the pre-trained ResNet-101 model\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = True\n",
        "\n",
        "# After GlobalAveragePooling2D layer, concatenate with the categorical input\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.01))(x)\n",
        "\n",
        "# Add Custom Layers for Categorical Data\n",
        "y = Dense(64, activation='relu')(categorical_input)\n",
        "x = Concatenate()([x, y])\n",
        "\n",
        "#x = BatchNormalization()(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model with both image and categorical inputs\n",
        "model_resnet = Model(inputs=[base_model.input, categorical_input], outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.0005\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,\n",
        "    decay_rate=0.9\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=False)\n",
        "\n",
        "model_resnet.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n"
      ],
      "metadata": {
        "id": "QzLi1vw-UL8m"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# Train the model with data augmentation and callbacks\n",
        "epochs = 60\n",
        "batch_size = 60\n",
        "history = model_resnet.fit(\n",
        "    [X_train_image, encoded_train],\n",
        "    y_train,\n",
        "    epochs=epochs,\n",
        "    batch_size=batch_size,\n",
        "    callbacks=[learning_rate_reduction ,early_stopping ],\n",
        "    validation_data=([X_test_image, encoded_test], y_test)\n",
        ")\n",
        "\n",
        "# Plot the training and validation loss\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()"
      ],
      "metadata": {
        "id": "SUDxW6kWUO6M"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "Y_pred = model_resnet.predict([X_test_image, encoded_test])\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)\n"
      ],
      "metadata": {
        "id": "WsYJkXiEUO9D"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "nhsavoRQlNXJ"
      },
      "source": [
        "## Baseline: Without Data Augmentation\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "4THAVLErBbr_"
      },
      "source": [
        "### Resnet Without Data Augmentation\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "DfOuBHCSZ4Aj"
      },
      "outputs": [],
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "6WNPjF0EK16u"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "gJwhAHA3lGgu"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "# Load the pre-trained ResNet-50 model (weights pre-trained on ImageNet)\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 143  # Choose the number of layers you want to freeze for ResNet50\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Redefining FC Layer since include_top is set to False\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = Dense(256, activation='relu')(x)\n",
        "predictions = Dense(7, activation='softmax')(x)  # Assuming you have 7 classes\n",
        "\n",
        "# Create the final model\n",
        "model_resnet = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.01\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule)\n",
        "\n",
        "model_resnet.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "-o3DzJVwAd65"
      },
      "outputs": [],
      "source": [
        "import plotly.graph_objects as go"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "7XUDT71KZab-"
      },
      "outputs": [],
      "source": [
        "# Fit the model\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "\n",
        "history = model_resnet.fit(\n",
        "    x_train, y_train,\n",
        "    batch_size=batch_size,\n",
        "    epochs=epochs,\n",
        "    verbose=1,\n",
        "    callbacks=[learning_rate_reduction, early_stopping],\n",
        "    validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "vtGMvumNb37Z"
      },
      "outputs": [],
      "source": [
        "# Function to plot the confusion matrix with Plotly\n",
        "def plot_confusion_matrix(cm, classes, normalize=False):\n",
        "    if normalize:\n",
        "        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n",
        "        colorscale = 'Plasma'\n",
        "    else:\n",
        "        colorscale = 'Magma_r'  # Reversed 'Magma' colorscale for non-normalized matrix\n",
        "\n",
        "    annotations = []\n",
        "    for i in range(len(classes)):\n",
        "        for j in range(len(classes)):\n",
        "            annotations.append(\n",
        "                {\n",
        "                    'x': classes[j],\n",
        "                    'y': classes[i],\n",
        "                    'text': str(cm[i, j]),\n",
        "                    'showarrow': False,\n",
        "                    'font': {'color': 'red' if cm[i, j] > 0.5 else 'black'}\n",
        "                }\n",
        "            )\n",
        "\n",
        "    fig = go.Figure(data=go.Heatmap(\n",
        "        z=cm,\n",
        "        x=list(classes),\n",
        "        y=list(classes),\n",
        "        colorscale=colorscale,\n",
        "        colorbar=dict(title='Normalized' if normalize else 'Count'),\n",
        "        showscale=True,\n",
        "        hoverinfo='z'\n",
        "    ))\n",
        "\n",
        "    fig.update_layout(\n",
        "        title='Confusion Matrix',\n",
        "        xaxis=dict(title='Predicted label'),\n",
        "        yaxis=dict(title='True label'),\n",
        "        annotations=annotations\n",
        "    )\n",
        "\n",
        "    if normalize:\n",
        "        fig.update_layout(title_text='Normalized Confusion Matrix')\n",
        "    else:\n",
        "        fig.update_layout(title_text='Confusion Matrix (Counts)')\n",
        "\n",
        "    fig.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "WvLkWH-5aiwD"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_resnet.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "HWUGCslkBgMT"
      },
      "source": [
        "### Resnet With Data Augmentation\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "gr2PzQcAPg7Y"
      },
      "source": [
        "### Standardize and Augmentation"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ErTTUKo3PcIn"
      },
      "outputs": [],
      "source": [
        "# Create an ImageDataGenerator with standardization\n",
        "\n",
        "datagen2 = ImageDataGenerator(\n",
        "        featurewise_center=True,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=True,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.12,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.12,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=True,  # randomly flip images\n",
        "        vertical_flip=True)  # randomly flip images\n",
        "\n",
        "# Fit the ImageDataGenerator to your training data\n",
        "datagen2.fit(x_train)\n",
        "\n",
        "# Fit the model using the generator\n",
        "history = model_resnet.fit_generator(\n",
        "    datagen2.flow(x_train, y_train, batch_size=batch_size),\n",
        "    epochs=epochs,\n",
        "    verbose=1,\n",
        "    steps_per_epoch=x_train.shape[0] // batch_size,\n",
        "    callbacks=[learning_rate_reduction, early_stopping],\n",
        "    validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "8Emsm8rlUEas"
      },
      "outputs": [],
      "source": [
        "# Create an ImageDataGenerator with standardization\n",
        "rescale_factor = 1.0/255\n",
        "datagen3 = ImageDataGenerator(rescale = rescale_factor,\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.12,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.12,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=True,  # randomly flip images\n",
        "        vertical_flip=True)  # randomly flip images\n",
        "\n",
        "# Fit the ImageDataGenerator to your training data\n",
        "datagen3.fit(x_train)\n",
        "\n",
        "# Fit the model using the generator\n",
        "history = model_resnet.fit_generator(\n",
        "    datagen3.flow(x_train, y_train, batch_size=batch_size),\n",
        "    epochs=epochs,\n",
        "    verbose=1,\n",
        "    steps_per_epoch=x_train.shape[0] // batch_size,\n",
        "    callbacks=[learning_rate_reduction, early_stopping],\n",
        "    validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "eJJpaO6EfgLz"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_resnet.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ZoHZUXgrhajs"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Wby-IZaghbup"
      },
      "source": [
        "### ResNet50 Batch Norm and Dropout\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "GGWLGWmeh3xd"
      },
      "outputs": [],
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "1onDuAUFh3zg"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Dropout\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "# Load the pre-trained ResNet-50 model (weights pre-trained on ImageNet)\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze the layers of the base model\n",
        "for layer in base_model.layers:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Add custom layers\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = BatchNormalization()(x)  # Batch Normalization layer\n",
        "x = Dropout(0.5)(x)  # Dropout layer\n",
        "x = Dense(256, activation='relu')(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model\n",
        "model_resnet = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.01\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule)\n",
        "\n",
        "model_resnet.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ZQ3ocM3oiIiM"
      },
      "outputs": [],
      "source": [
        "# Fit the model WUTHOUT AUG\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "\n",
        "history = model_resnet.fit(\n",
        "    x_train, y_train,\n",
        "    batch_size=batch_size,\n",
        "    epochs=epochs,\n",
        "    verbose=1,\n",
        "    callbacks=[learning_rate_reduction, early_stopping],\n",
        "    validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "H1dCES5tiTwX"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_resnet.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "4aUQzRyGiT94"
      },
      "outputs": [],
      "source": [
        "#WITH AUGMENTATION\n",
        "# Fit the model\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "\n",
        "history = model_resnet.fit_generator(datagen.flow(x_train, y_train, batch_size=batch_size),\n",
        "                                     epochs=epochs, verbose=1,\n",
        "                                     steps_per_epoch= x_train.shape[0] // batch_size,\n",
        "                                     callbacks= [learning_rate_reduction, early_stopping],\n",
        "                                     validation_data= (x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "L8Upg0NBibx5"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_resnet.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "DLV0RA-HbdGl"
      },
      "source": [
        "##### DenseNET WITH BATCHNORM AND DROPOUT"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "d7wyWvTiVBx2"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import DenseNet201\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Dropout\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "# Load the pre-trained ResNet-50 model (weights pre-trained on ImageNet)\n",
        "base_model = DenseNet201(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze the layers of the base model\n",
        "for layer in base_model.layers:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Add custom layers\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = BatchNormalization()(x)  # Batch Normalization layer\n",
        "x = Dropout(0.5)(x)  # Dropout layer\n",
        "x = Dense(256, activation='relu')(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model\n",
        "model_dense = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.01\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule)\n",
        "\n",
        "model_dense.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "gIYImcDLVTvO"
      },
      "outputs": [],
      "source": [
        "# Fit the model WUTHOUT AUG\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "history = model_dense.fit(\n",
        "    x_train, y_train,\n",
        "    batch_size=batch_size,\n",
        "    epochs=epochs,\n",
        "    verbose=1,\n",
        "    callbacks=[learning_rate_reduction, early_stopping],\n",
        "    validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "p-IK_NTHVTx6"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_dense.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<DENSENET201>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "2T8PavnzVZ3C"
      },
      "outputs": [],
      "source": [
        "#WITH AUGMENTATION\n",
        "# Fit the model\n",
        "epochs = 50\n",
        "batch_size = 60\n",
        "\n",
        "history = model_dense.fit_generator(datagen.flow(x_train, y_train, batch_size=batch_size),\n",
        "                                     epochs=epochs, verbose=1,\n",
        "                                     steps_per_epoch= x_train.shape[0] // batch_size,\n",
        "                                     callbacks= [learning_rate_reduction, early_stopping],\n",
        "                                     validation_data= (x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy')\n",
        "plt.show()\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "H96gEhPGVZ51"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_dense.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "LHKXWPsubphY"
      },
      "source": [
        "#### STANDARDIZATION + AUGEMENTATION + BATCHNORM + DROPOUT"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "z-Oxb4Qet5RI"
      },
      "outputs": [],
      "source": [
        "#Adding normalization and standardization to train test split\n",
        "\n",
        "def train_test_df_normstandard(df):\n",
        "    features=df.drop(columns=['cell_type_idx'],axis=1)\n",
        "    target=df['cell_type_idx']\n",
        "\n",
        "    # Create First Train and Test sets\n",
        "    x_train_o, x_test_o, y_train_o, y_test_o = train_test_split(features, target, test_size=0.20,random_state=123)\n",
        "\n",
        "    x_train = np.asarray(x_train_o['image'].tolist())\n",
        "    x_test = np.asarray(x_test_o['image'].tolist())\n",
        "\n",
        "    #Normalization\n",
        "    x_train = x_train / 255\n",
        "    x_test = x_test / 255\n",
        "\n",
        "    #The standardization is done using the training set Mean and Std. Deviation as reference\n",
        "    x_train_mean = np.mean(x_train)\n",
        "    x_train_std = np.std(x_train)\n",
        "\n",
        "    x_train = (x_train - x_train_mean)/x_train_std\n",
        "    x_test = (x_test - x_train_mean)/x_train_std\n",
        "\n",
        "    # Perform one-hot encoding on the labels\n",
        "    y_train = to_categorical(y_train_o, num_classes = 7)\n",
        "    y_test = to_categorical(y_test_o, num_classes = 7)\n",
        "\n",
        "    #Splitting training into Train and Validatation sets\n",
        "    x_train, x_validate, y_train, y_validate = train_test_split(x_train, y_train, test_size = 0.1,random_state=123)\n",
        "\n",
        "    #Reshaping the Images into 3 channels (RGB)\n",
        "    x_train = x_train.reshape(x_train.shape[0], *(100, 125, 3))\n",
        "    x_test = x_test.reshape(x_test.shape[0], *(100, 125, 3))\n",
        "    x_validate = x_validate.reshape(x_validate.shape[0], *(100, 125, 3))\n",
        "\n",
        "    return x_train,x_validate,x_test,y_train,y_validate,y_test\n",
        "\n",
        "x_train,x_validate,x_test,y_train,y_validate,y_test = train_test_df_normstandard(df_clean) #change to df_clean"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "4aF0IhEo4Z5y"
      },
      "outputs": [],
      "source": [
        "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
        "\n",
        "#Data augmentation to prevent overfitting\n",
        "datagen = ImageDataGenerator(\n",
        "        featurewise_center=False,  # set input mean to 0 over the dataset\n",
        "        samplewise_center=False,  # set each sample mean to 0\n",
        "        featurewise_std_normalization=False,  # divide inputs by std of the dataset\n",
        "        samplewise_std_normalization=False,  # divide each input by its std\n",
        "        zca_whitening=False,  # apply ZCA whitening\n",
        "        rotation_range=10,  # randomly rotate images in the range (degrees, 0 to 180)\n",
        "        zoom_range = 0.1, # Randomly zoom image\n",
        "        width_shift_range=0.12,  # randomly shift images horizontally (fraction of total width)\n",
        "        height_shift_range=0.12,  # randomly shift images vertically (fraction of total height)\n",
        "        horizontal_flip=True,  # randomly flip images\n",
        "        vertical_flip=True)  # randomly flip images\n",
        "\n",
        "datagen.fit(x_train)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "yq9D6L8x4Z8p"
      },
      "outputs": [],
      "source": [
        "from tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\n",
        "\n",
        "# Set a learning rate annealer\n",
        "learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n",
        "                                            patience=3,\n",
        "                                            verbose=1,\n",
        "                                            factor=0.5,\n",
        "                                            min_lr=0.00001)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "B8ySgXMH4Z_h"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras.applications import ResNet50\n",
        "from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, BatchNormalization, Dropout\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.optimizers import Adam\n",
        "from tensorflow.keras.callbacks import EarlyStopping\n",
        "\n",
        "# Load the pre-trained ResNet-50 model (weights pre-trained on ImageNet)\n",
        "base_model = ResNet50(weights='imagenet', include_top=False)\n",
        "\n",
        "# Freeze some layers in the base model\n",
        "num_layers_to_freeze = 95  # Choose the number of layers you want to freeze\n",
        "for layer in base_model.layers[:num_layers_to_freeze]:\n",
        "    layer.trainable = False\n",
        "\n",
        "# Add custom layers\n",
        "x = base_model.output\n",
        "x = GlobalAveragePooling2D()(x)\n",
        "x = BatchNormalization()(x)  # Batch Normalization layer\n",
        "x = Dropout(0.5)(x)  # Dropout layer\n",
        "x = Dense(256, activation='relu')(x)\n",
        "predictions = Dense(7, activation='softmax')(x)\n",
        "\n",
        "# Create the final model\n",
        "model_resnet = Model(inputs=base_model.input, outputs=predictions)\n",
        "\n",
        "# Learning Rate Scheduler\n",
        "initial_learning_rate = 0.01\n",
        "lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(\n",
        "    initial_learning_rate,\n",
        "    decay_steps=10000,   # Adjust decay_steps\n",
        "    decay_rate=0.9       # Adjust decay_rate\n",
        ")\n",
        "optimizer = Adam(learning_rate=lr_schedule)\n",
        "\n",
        "model_resnet.compile(optimizer=optimizer, loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
        "\n",
        "# Early Stopping\n",
        "early_stopping = EarlyStopping(monitor='val_loss', patience=15, restore_best_weights=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "NvM7e6Qe4aCH"
      },
      "outputs": [],
      "source": [
        "epochs = 50\n",
        "batch_size = 60\n",
        "history = model_resnet.fit_generator(datagen.flow(x_train, y_train, batch_size=batch_size),\n",
        "epochs=epochs, verbose=1, steps_per_epoch=x_train.shape[0] // batch_size,\n",
        "callbacks=[learning_rate_reduction, early_stopping], validation_data=(x_validate, y_validate))\n",
        "\n",
        "# Plot the training and validation loss\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['loss'], label='Training Loss')\n",
        "plt.plot(history.history['val_loss'], label='Validation Loss')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Loss')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Loss (ResNet50 with Input Normalization)')\n",
        "plt.show()\n",
        "\n",
        "# Plot the training and validation accuracy\n",
        "plt.figure(figsize=(10, 5))\n",
        "plt.plot(history.history['accuracy'], label='Training Accuracy')\n",
        "plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n",
        "plt.xlabel('Epochs')\n",
        "plt.ylabel('Accuracy')\n",
        "plt.legend()\n",
        "plt.title('Training and Validation Accuracy (ResNet50 with Input Normalization)')\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "zU4-6W9B4aEv"
      },
      "outputs": [],
      "source": [
        "#Printing classification report\n",
        "from sklearn.metrics import confusion_matrix, classification_report\n",
        "\n",
        "classes = range(7)\n",
        "\n",
        "# Y_true (true labels) and Y_pred_classes (predicted labels) Evaluating performance on test set\n",
        "Y_pred = model_resnet.predict(x_test)\n",
        "Y_pred_classes = np.argmax(Y_pred, axis=1)\n",
        "Y_true = np.argmax(y_test, axis=1)\n",
        "\n",
        "# Compute the confusion matrix\n",
        "confusion_mtx = confusion_matrix(Y_true, Y_pred_classes)\n",
        "\n",
        "# Plot the confusion matrix with the new colorscale\n",
        "plot_confusion_matrix(confusion_mtx, classes=classes, normalize=False)\n",
        "\n",
        "report = classification_report(Y_true, Y_pred_classes)\n",
        "print(f\"Classification Report for <<ResNet50>> : \")\n",
        "print(report)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "93XOwEbF4aHl"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Tbc1cFC1t5ZO"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "rs1ILQzaSlop"
      },
      "source": [
        "## Now Introducing with Input Normalization vs Without Input Normalization"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "bNK2caIgli6V"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow.keras import datasets, layers, models\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "normalizer = layers.Normalization()\n",
        "normalizer.adapt(x_train)\n",
        "\n",
        "# Create a model that include the normalization layer\n",
        "inputs = Input(shape=x_train.shape[1:])\n",
        "x = normalizer(inputs)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "_-5wAh3-SwLU"
      },
      "source": [
        "## Build Off Which One Is Better + Batch Normalization vs w/o Batch Normalization"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "7vNoDKZXTAtJ"
      },
      "source": [
        "## Hyperparamater Tuning using GridSearchCV\n",
        "\n",
        "1. Different Learning Rates but with same Learning Rate Scheduler\n",
        "3. Different Optimizer\n",
        "4. Different Activation Function\n",
        "5. Instead of optimizing accuracy, we would want to optimize F1 score\n",
        "6. Vary Number of Layers to Freeze\n",
        "7. Vary Dropout Rate\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "O-wn7HkGoGn7"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "collapsed_sections": [
        "4THAVLErBbr_",
        "Wby-IZaghbup",
        "rs1ILQzaSlop",
        "7vNoDKZXTAtJ"
      ],
      "provenance": [],
      "gpuType": "T4"
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
